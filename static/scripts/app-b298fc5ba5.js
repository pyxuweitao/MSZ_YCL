/**
 * Created by centi on 2015/6/9.
 */
"use strict";angular.module("DEVBYCM.cmSideMenuBox",[]).directive("cmSideMenuBox",function(){return{restrict:"E",template:"<div ng-transclude></div>",transclude:!0,link:function(){}}}).directive("cmSideMenu",function(){return{restrict:"E",template:'<ng-include src="\'app/components/ui/cmNavBar/template.html\'"></ng-include>\n<div ng-transclude style="position: absolute;top: 45px;right: 0;bottom: 0;left: 0;overflow-y: auto"></div>',transclude:!0}}).directive("cmSideMenuContent",function(){return{restrict:"E"}}).directive("cmSideMenuContentHeader",function(){return{restrict:"EA",scope:!1,template:"<div ng-transclude></div>",transclude:!0,link:function(e,t){t.after("<div></div>"),t.next().css("height",t.prop("offsetHeight")+"px"),t.css("top",t.parent()[0].scrollTop+"px"),t.parent().on("scroll",function(){t.css("top",t.parent()[0].scrollTop+"px")})}}}),angular.module("DEVBYCM.cmNotificationAreaModule",[]).directive("cmPerson",["$rootScope","AccountSvc","LoginSvc","cmLoginSvc","cmLoadingSvc",function(e,t,n,o,i){return{restrict:"E",templateUrl:"app/components/ui/cmNotificationArea/template.html",scope:{},link:function(s){s.uiIsPanelShow=!1,s.currentUser=t.getCurrentUser(),s.funcSwitchUser=function(){s.uiIsPanelShow=!1,o.show()},s.funcLogout=function(){s.uiIsPanelShow=!1,i.setContent("正在登出...","inProgress"),i.show(),n.logout().then(function(){i.setContent("您已注销","success")},function(){i.setContent("登出失败","error")})["finally"](function(){i.hide()})},e.$on("cmLogin",function(){s.currentUser=t.getCurrentUser()})}}}]),angular.module("DEVBYCM.cmNavMenu",[]).directive("cmNavMenu",["cmNavBarService","$rootScope","$state",function(e,t,n){return{restrict:"E",templateUrl:"app/components/ui/cmNavMenu/template.html",transclude:!0,controller:function(){},link:function(o){o.menuItems=e.getMenu(),o.show=!1,o.goAndClose=function(e,t){n.go(e,t),o.show=!1},o.close=function(){o.show=!1},t.$on("cmNavMenu",function(e,t){t&&!angular.isUndefined(t.toggle)&&(o.show=!o.show)})}}}]),angular.module("DEVBYCM.cmNavBarModule",[]).controller("cmNavBarCtrl",["$scope","$rootScope","$state","cmNavBarService","cmBackSvc",function(e,t,n,o,i){e.canGoBack=i.canGoBack(),e.$watch(function(){return i.canGoBack()},function(){e.canGoBack=i.canGoBack()}),e.goBack=function(){e.canGoBack&&(e.canGoBack=i.goBack())},e.title="",t.$on("cmNavBar",function(t,n){n&&!angular.isUndefined(n.title)&&(e.title=n.title)});var s=function(t,n){e.menuItem=o.getMatchedMenuItem(t,n)};s(n.current.name,n.params),e.toggleMenu=function(){t.$broadcast("cmNavMenu",{toggle:!0})},t.$on("$stateChangeStart",function(e,t,n){s(t.name,n)})}]).factory("cmNavBarService",["$rootScope",function(e){return{setTitle:function(t){e.$broadcast("cmNavBar",{title:t})},getMenu:function(){return[{title:"首页",label:"平台首页",icon:"ion-ios-home-outline",show:!0,state:"home",params:{},match:function(e){return"home"===e}},{title:"收货",label:"收货报告",icon:"ion-ios-list-outline",show:!0,state:"home.process.formList",params:{Class:"收货",ProcessTypeId:"ARRIVAL",Rev:0,ProcessNodeTypeId:"AR01"},match:function(e,t){return"home.process.formList"===e&&"收货"===t.Class}},{title:"主料",label:"主料检验",icon:"ion-ios-paper-outline",show:!0,state:"home.process.processList",params:{Class:"主料",ProcessTypeId:void 0,Rev:void 0},match:function(e,t){return"home.process.processList"===e&&"主料"===t.Class}},{title:"辅料",label:"辅料检验",icon:"ion-ios-paper-outline",show:!0,state:"home.process.processList",params:{Class:"辅料",ProcessTypeId:void 0,Rev:void 0},match:function(e,t){return"home.process.processList"===e&&"辅料"===t.Class}},{title:"管理",label:"系统管理",icon:"ion-ios-cog-outline",show:!0,state:"home.control.feedbackNew",params:{},match:function(e){return"home.control.feedbackNew"===e}},{title:"表单",label:"",icon:"ion-ios-photos-outline",state:"home.process.detailForm",params:{},match:function(e){return"home.process.detailForm"===e}}]},getMatchedMenuItem:function(e,t){var n=[];return angular.forEach(this.getMenu(),function(n){n&&n.match(e,t)&&this.push(n)},n),n[0]}}}]).factory("cmBackSvc",["$rootScope","$state",function(e,t){var n=[];return n.push({state:t.current.name,params:t.params}),e.$on("$stateChangeSuccess",function(){n.push({state:t.current.name,params:t.params})}),{removeLastVisit:function(){var e=n.pop();n.pop(),n.push(e)},canGoBack:function(){return n.length>1},goBack:function(){n.pop();var e=n.pop();return t.go(e.state,e.params),n.length>0}}}]),angular.module("DEVBYCM.cmLoginModule",[]).directive("cmLogin",["$rootScope","cmLoginSvc","LoginSvc",function(e,t,n){return{restrict:"E",templateUrl:"app/components/ui/cmLogin/template.html",scope:{},link:function(t){t.isShow=!1,t.isLoggedIn=n.isLoggedIn(),t.funcTryToClose=function(){t.isLoggedIn&&(t.isShow=!1)},e.$on("cmLogin",function(e,o){o&&!angular.isUndefined(o.show)&&(t.isShow=o.show),t.isLoggedIn=n.isLoggedIn()})}}}]).factory("cmLoginSvc",["$rootScope","$timeout",function(e,t){return{show:function(){e.$broadcast("cmLogin",{show:!0})},hide:function(n){return angular.isUndefined(n)&&(n=1e3),t(function(){e.$broadcast("cmLogin",{show:!1})},n)}}}]).controller("cmLoginCtrl",["$scope","$state","cmLoginSvc","LoginSvc",function(e,t,n,o){e.uiIsHover=!1,e.uiCurrentHoverIndex=null,e.uiIsLoggingIn=!1,e.uiIsInputError=!1;var i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAAAAAB5Gfe6AAAAAmJLR0QA/4ePzL8AAAW0SURBVHja7d29jus4DAVgvv97pVDhFCrGjQtjAAeIGzVqXGmBiy12t9ixrUOGR0O+gb6QlOIfWh6/PCQAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAiAAAgAV0/y9l1rbnzhq3V9LTr8EIM2vvxf+3zjKkkcHyGtp/xvHPqdhAaa1thNxFMtqsAPIpZ2OY02DAaRzP/6/0mAkgPVo16M8RwG4kvzmhaAPkG4u/w/Bwg9wK/sN60D8/vw2SaALkI/WH1uiBVgbJOqTEyC9GyiOL0aA/vI3aQRqAKk2ZCxsAM+jYWPjAkjo9be2MgGA81+zCsR7//tHfNEAvFXW345MArA2pTgSBUBualEYABQ2AM2tAA9QmmZk9wCr6vrxbUCYCkCjCISqABSKQGh2AKWdQNgSAJ0CwtQBNfqgUHVAhT4odAkATgEoQLUBaLNTgGy0fuhGIGRbAHwjAAJMZutvu0uA1Q4A2AaFrwVi26DwtUBsGxTGCkDWgBDuAdB9AAaQTNffXu4AZluA6g7gZQvQkjeAagwwewMwXn/7dgYwWQPszgBma4DqDODbGqA5A9jNASZfAMUcIPsCqOYAcwC4AjBfP+ogEAABEAABEACAOMwBFl8AcRD67QC//s/Qyxwg+QJYrNd/OLsekK0BijOAZA3wcgZgfhBYvAFYXxLK3gAWzh6IA8icPRB4e/ygbAFAANuz4OQPwPTeEOzuOBAgWdbA6hDAdCPMHgEy4R4ABTCsgdUlgN2Dcsjn5ZEAZimAfGMC+r5AoWuBYIBM1wLRL00VugQAAzwtusD28AtgsRGA3x4GAxhsBOCXh9HvDqtfF6nJN4B6H0QPEIADKPfB7eEdQLcIavIP8NgUdwD8YD0FgKR3p1hhmJTGHCG1NrA9OAAeXzoC78QCoNMIq8psUaVxegvL+tUGKm4EG4AqAPpvkdpkWb2hqgtB/qsCIPeCt95sZc3ByhkloDlbWnWyNGa0pu50ceXh6qvj9mcC0F8Gm/JHFtS/L5C6kqCqf2nE4BMb+XYnsPjGhslHVm7WwWbxrR0DgLTeTIEyxEdWculogwZfGxLlH7/76lBVTgNRXT7kKKjbCsX78rUJxP/ydQmEYfmaBCoAWeXCuM6pUOO+gNrtwUIxXn9VvDl4+J8u/1S+Owz/+BoYYFF/QAJ9eQQ7WPndDOLtdrJ0NnpQ8nD6nOBi9qwwsgxwAxW3Zhibu5Gayfi1ueJsnuDT/PV51MVioWp/Cq0QAvD1gfWjvkMptOsHCQAAlvaxWDwAfHD9CAGhXj9AQEjrH9YHhHv9/QJ9AM+Pr7/76SlhX3+vQA9Aqs1FdD1B1QPwbk7i/RmArbmJ7RMAS3MUiz2AjwbY3wiFvAF2N0LhbwB9bUAGaABdbUAGaABdbeAeQGkOo9gBrM1lrFYAHgvgdhHIKAVwtwhkmAK4WQTXAdLhF+DGcAXhPwL1HYcuA+TmOrI6QPENULQBnCfA9RSQcTrgvT4ow2yBN7dCGSwBLqeAjJYAV1NARkuAqykgwyXAxRSQ4RLgYgrIeAlwLQWuAFQWgKoDkBtNZBWAwgNQNACIEuBKCsh4LfBaG5TR9sCrO+FpgLlRxQwHKFwABQ0wNbKYwAArG8AKBqhsABULkBtdZCjAygewQgEqH0BFAhBWwNkakFEr4GwNyIinoCtnoVMAqVFGggHMnAAzDGDnBNhhAJUToKIApkYaEwhgZgWYQQA7K8AOAqisABUDkBptJAhA5gXIEICFF2CBAOy8ADsEoPICVAQAcQ880wVl5B54pgvKuOfAc2fBnwFezAAvAMDODLADACozQAUAHMwARz8A9S54Yh/8EWDiBpi6AWZugDkAegG+uQG+uwFe3ACvboCdG2DvBijcAKUboHID/HgU/Aui+qF7tg7BJAAAAABJRU5ErkJggg==",s={Id:null,Password:null,Avatar:i,AutoUpdateSavedUser:!1};e.selectedUser=angular.copy(s),e.savedUsers=o.getSavedUsers(),e.uiWhichPanel="switch";var r=function(t){e.uiWhichPanel="login",e.selectedUser=angular.copy(t)};!function(){0===e.savedUsers.length?r(s):1===e.savedUsers.length&&r(e.savedUsers[0])}(),e.funcRemoveUser=function(t){e.savedUsers.splice(t,1),o.setSavedUsers(e.savedUsers)},e.funcDisplayUserSwitch=function(){e.uiWhichPanel="switch"},e.funcDisplayNewUserLogin=function(){e.uiWhichPanel="login",r(s)},e.funcDisplayUserLogin=function(e){r(e)},e.funcUserIdChanged=function(){e.selectedUser.Avatar=i},e.funcCancelInputErrorMark=function(){e.uiIsInputError=!1},e.funcLogin=function(){e.uiIsLoggingIn=!0;var i=e.selectedUser,s=function(t){var n=e.savedUsers,i=-1;angular.forEach(n,function(e,n){e.Id===t.Id&&(i=n)}),-1===i?n.push(t):n[i]=t,e.savedUsers=n,o.setSavedUsers(n)};o.login(i.Id,i.Password).then(function(o){i.AutoUpdateSavedUser&&(o.AutoUpdateSavedUser=!0,o.Password=i.Password,s(o)),e.uiWhichPanel="success",n.hide(1500).then(function(){e.funcDisplayUserSwitch(),t.reload()})},function(){e.uiIsInputError=!0})["finally"](function(){e.uiIsLoggingIn=!1})}}]),angular.module("DEVBYCM.cmLoadingModule",[]).directive("cmLoading",["cmLoadingSvc","$rootScope",function(e,t){return{restrict:"E",templateUrl:"app/components/ui/cmLoading/template.html",scope:{},link:function(e){e.isShow=!1,e.content="",e.status="",t.$on("cmLoading",function(t,n){n&&!angular.isUndefined(n.show)&&(e.isShow=n.show),n&&!angular.isUndefined(n.content)&&(e.content=n.content),n&&!angular.isUndefined(n.status)&&(e.status=n.status)})}}}]).factory("cmLoadingSvc",["$rootScope","$timeout",function(e,t){var n=[],o={};return{show:function(){n.push(o),e.$broadcast("cmLoading",{show:!0})},hide:function(o){return n.pop(),n.length>0?void e.$broadcast("cmLoading",n[length-1]):(angular.isUndefined(o)&&(o=1e3),t(function(){e.$broadcast("cmLoading",{show:!1})},o))},setContent:function(t,n){o={content:t,status:n},e.$broadcast("cmLoading",o)}}}]),angular.module("RMI.ProcessCtrls",[]).controller("ProcessListCtrl",["$scope","$state","$filter","$timeout","FormSvc","ProcessSvc","cmNavBarService","cmLoadingSvc",function(e,t,n,o,i,s,r,a){e.stateParams=t.params,e.uiIsSideMenuListLoaded=!1,function(){s.fetchProcessTypesByClass(e.stateParams.Class).then(function(t){e.sideMenuList=t,a.setContent("加载完成")},function(e){console.log(e)})["finally"](function(){e.uiIsSideMenuListLoaded=!0,a.hide(750)})}(),e.funcCreateForm=function(){a.setContent("收货报告创建中"),a.show(),i.requestCreate("ARRIVAL","ARRIVAL",0,"AR01").then(function(e){t.go("home.process.detailForm",{ArrivalSerialNumber:e.ArrivalSerialNumber,FormId:e.Id,Mode:"edit"})},function(e){a.setContent("创建过程发生错误，请检查网络连接"),console.log(e)})["finally"](function(){a.hide(750)})},e.funcGoDetail=function(e,n,o){t.go("home.process.detailForm",{ArrivalSerialNumber:e,FormId:n,Mode:o})},e.funcGoDetailInfo=function(e){t.go("home.process.detailInfo",{ArrivalSerialNumber:e})},e.funcGoFormEdit=function(n,o,s){angular.equals(s,{})?(e.funcEditForm=function(e,n){a.setContent("数据加载中"),a.show(),t.go("home.process.detailForm",{ArrivalSerialNumber:e,FormId:n}),a.hide(100)},e.funcShortcutCreateFormAndRequestEditFormAndEditForm=function(n,o,s,r){a.setContent("正在尝试创建表单"),a.show(),i.requestCreate(n,o,s,r).then(function(o){t.reload(),e.funcEditForm(n,o.Id)},function(e){a.setContent("创建失败:"+e)})["finally"](function(){a.hide(750)})},e.funcShortcutCreateFormAndRequestEditFormAndEditForm(n.ArrivalSerialNumber,n.TypeId,n.Rev,o.Id)):e.funcGoDetail(n.ArrivalSerialNumber,s.Id,"edit")}}]).controller("ProcessListCountCtrl",["$scope","$state","$filter","$timeout","$window","ngTableParams","FormSvc","cmNavBarService","cmLoadingSvc",function(e,t,n,o,i,s,r,a,c){var l=[];e.uiIsFilterByCurrentUser=!1,e.tableDataOption={Status:4},e.tableParams=new s({page:1,count:500,sorting:{}},{total:l.length,counts:[],filterDelay:250,getData:function(e,t){l=n("orderBy")(l,["-CreateTime"]);var o=l;o=t.sorting?n("orderBy")(o,t.orderBy()):l,o=t.filter?n("filter")(o,t.filter()):o,e.resolve(o.slice((t.page()-1)*t.count(),t.page()*t.count()))}}),r.fetchForms(t.params.ProcessTypeId,t.params.Rev,t.params.ProcessNodeTypeId).then(function(t){l=t,e.tableParams.reload()},function(e){}),e.funcSubmitForm=function(e){var n=i.confirm("是否确认提交？");n===!0&&(c.setContent("正在提交表单"),c.show(),r.requestSubmitAndAddToArrivalAndAddToProcess(e).then(function(){c.setContent("提交成功"),t.reload()},function(e){console.log(e)})["finally"](function(){c.hide(750)}))}}]).controller("ProcessListInspectionCtrl",["$scope","$filter","$state","$q","$timeout","ngTableParams","ProcessSvc","FormSvc","AccountSvc","cmNavBarService","cmLoadingSvc",function(e,t,n,o,i,s,r,a,c,l,d){var u=[];e.tableDataOption={IsComplete:"true"===n.params.IsComplete||"false"===n.params.IsComplete||"waiting"===n.params.IsComplete?n.params.IsComplete:"false",StartTime:1,EndTime:2},e.funcChangeOption=function(e,t){var o=n.params;o[e]=t,n.go(n.current.name,o,{reload:!0})},e.tableParamsInProcessView=new s({page:1,count:999,sorting:{}},{total:u.length,counts:[],filterDelay:250,getData:function(e,n){var o=u;o=n.sorting?t("orderBy")(o,n.orderBy()):u,o=n.filter?t("filter")(o,n.filter()):o,e.resolve(o.slice((n.page()-1)*n.count(),n.page()*n.count()))}}),function(){d.setContent("载入列表："+n.params.ProcessTypeId,"inProgress"),d.show(),r.fetchProcessesByProcessTypeIdAndRev(n.params.ProcessTypeId,n.params.Rev,e.tableDataOption).then(function(t){angular.forEach(t,function(e){e.Parameter=angular.fromJson(e.Parameter)}),u=t,e.tableDataInProcessView=t,d.setContent("加载完成","success"),e.tableParamsInProcessView.reload()},function(e){d.setContent("加载失败","error")})["finally"](function(){d.hide(750)})}(),e.funcResetDefaultProcessType=function(){var e=c.getUserSetting("UserSetting.UI.Process.List.DefaultProcessType")[n.params.Class];e.Enable=!1;var t=c.getUserSetting("UserSetting.UI.Process.List.DefaultProcessType");t[n.params.Class]=e,c.setUserSetting("UserSetting.UI.Process.List.DefaultProcessType",t),n.go("home.process.processList",{Class:n.params.Class,ProcessTypeId:void 0,Rev:void 0})}}]).controller("ProcessDetailInfoCtrl",["$scope","$state","$filter","$timeout","$q","ProcessSvc","FormSvc","ControlDesignSvc","cmNavBarService","cmLoadingSvc",function(e,t,n,o,i,s,r,a,c,l){e.state=t,e.uiIsReferenceShow=!1,e.uiShowProcessNodeDetail=[],e.uiProcessNodeViewSwitch="edit",l.setContent("数据加载中"),e.nodes=[],e.references=[],e.process={},function(){s.fetchProcess(t.params.ArrivalSerialNumber).then(function(t){!function(){t.Parameter=angular.fromJson(t.Parameter)}(),e.process=t,angular.forEach(e.process.Nodes,function(e){e.Order=parseInt(e.Order)}),l.hide()},function(e){alert("Error : "+e)})}(),e.funcGetCurrentStageTabCode=function(e,t,n){return console.log(e,t,n),n||(n=0),t||(t=0),e?"4"===t.toString()?"0"===n.toString()?2:3:1:0},e.funcShowProcessNodeDetail=function(t){e.uiShowProcessNodeDetail=[],e.uiShowProcessNodeDetail[t]=!0},e.currentReference={},e.uiCurrentActiveReferenceIndex=null,e.funcSwitchReference=function(t){t===e.uiCurrentActiveReferenceIndex?(console.log("same"),e.uiIsReferenceShow=!e.uiIsReferenceShow):(e.currentReference=e.references[t],e.uiIsReferenceShow=!0),e.uiCurrentActiveReferenceIndex=t},e.funcHideReference=function(){e.uiIsReferenceShow=!1},e.funcViewSourceForm=function(e){t.go("home.process.detailForm",{ArrivalSerialNumber:"ARRIVAL",FormId:e,Mode:"View"})},e.funcEditForm=function(e,n){t.go("home.process.detailForm",{ArrivalSerialNumber:e,FormId:n,Mode:"Edit"})},e.funcViewForm=function(e,n){t.go("home.process.detailForm",{ArrivalSerialNumber:e,FormId:n,Mode:"View"})},e.funcCreateForm=function(e,n,o,i){l.setContent("正在尝试创建表单"),l.show(),r.requestCreate(e,n,o,i).then(function(){t.reload()},function(e){l.setContent("创建失败:"+e)})["finally"](function(){l.hide(750)})},e.funcRequestEditForm=function(e){l.setContent("正在获取表单编辑权限"),l.show(),r.requestEdit(e).then(function(){t.reload()},function(e){l.setContent("获取失败:"+e)})["finally"](function(){l.hide(750)})},e.funcConfirmForm=function(e){l.setContent("正在提交你对表单的确认"),l.show(),r.requestConfirm(e).then(function(){t.reload()},function(e){l.setContent("创建失败:"+e)})["finally"](function(){l.hide(750)})},e.funcCancelEditForm=function(e){l.setContent("正在获取表单编辑权"),l.show(),r.requestCancelEdit(e).then(function(){t.reload()},function(e){l.setContent("获取失败:"+e)})["finally"](function(){l.hide(750)})},e.funcSubmitForm=function(e){l.setContent("正在提交表单"),l.show(),r.requestSubmit(e).then(function(){t.reload()},function(e){l.setContent("提交失败:"+e)})["finally"](function(){l.hide(750)})},e.funcShortcutCreateFormAndRequestEditFormAndEditForm=function(n,o,i,s){l.setContent("正在尝试创建表单"),l.show(),r.requestCreate(n,o,i,s).then(function(o){t.reload(),e.funcEditForm(n,o.Id)},function(e){l.setContent("创建失败:"+e)})["finally"](function(){l.hide(750)})},e.funcShortcutRequestEditFormAndEditForm=function(n,o){l.setContent("正在获取表单编辑权"),l.show(),r.requestEdit(o).then(function(){t.reload(),e.funcEditForm(n,o)},function(e){l.setContent("获取失败:"+e)})["finally"](function(){l.hide(750)})},e.funcShortcutConfirmFormAndSubmitForm=function(t){var n=window.confirm("确定要提交吗？");n&&e.funcSubmitForm(t)},e.$on("destroy",function(){createFormTimer&&o.cancel(createFormTimer),editFormTimer&&o.cancel(editFormTimer),confirmFormTimer&&o.cancel(confirmFormTimer),cancelEditFormTimer&&o.cancel(cancelEditFormTimer),submitFormTimer&&o.cancel(submitFormTimer)}),e.funcMarkProcessComplete=function(e){var n=window.confirm("请确认标记该检验任务完成吗？");if(n){l.setContent("正在标记完成","inProgress"),l.show();var o=s.updateProcessIsComplete(e,"true"),r=i.all([o]);r.then(function(){l.setContent("检验任务已经标记为完成","success"),t.reload()},function(){l.setContent("操作失败","error")})["finally"](function(){l.hide()})}},e.funcMarkProcessWaiting=function(e){var n=window.confirm("请确认是否提交最后审核？\n注意：确认后负责人将收到最后审核通知，并将检验任务标为完成");if(n){l.setContent("正在提交","inProgress"),l.show();var o=s.updateProcessIsComplete(e,"waiting"),r=i.all([o]);r.then(function(){l.setContent("提交成功","success"),t.reload()},function(){l.setContent("操作失败","error")})["finally"](function(){l.hide()})}},e.funcRedoComplete=function(e){var n=window.confirm("请确认重置该检验任务完成状态吗？\n注意：标记后是否完成重置为否");if(n){l.setContent("正在重置状态","inProgress"),l.show();var o=s.updateProcessIsComplete(e,"false"),r=i.all([o]);r.then(function(){l.setContent("检验任务已回到未完成状态","success"),t.reload()},function(){l.setContent("重置失败","error")})["finally"](function(){l.hide()})}},e.funcUpdateProcessNodeAvailableFlag=function(e,n,i){l.setContent("修改可用性中...","inProgress"),l.show(),s.updateProcessNodeAvailableFlag(e,n,i).then(function(){l.setContent("修改成功","success")},function(e){l.setContent("修改失败","error"),console.log(e)})["finally"](function(){l.hide(),o(function(){t.reload()},1e3)})},e.funcCheckPass=function(e,n){l.setContent("提交审核结果中...","inProgress"),l.show(),s.updateProcessNodeCheckStatus(e,n,1).then(function(){l.setContent("修改成功","success")},function(e){l.setContent("修改失败","error"),console.log(e)})["finally"](function(){l.hide(),o(function(){t.reload()},1e3)})},e.funcCheckDeny=function(e,n){l.setContent("提交审核结果中...","inProgress"),l.show(),s.updateProcessNodeCheckStatus(e,n,2).then(function(){l.setContent("修改成功","success")},function(e){l.setContent("修改失败","error"),console.log(e)})["finally"](function(){l.hide(),o(function(){t.reload()},1e3)})},e.funcRedoFormAndCheck=function(e,n,o){var a=window.confirm("确定要重做该项目吗？\n注意：重做会取消审核结论，并将表单置为可编辑");if(a){l.setContent("正在重设检验项状态","inProgress"),l.show();var c=s.updateProcessNodeCheckStatus(e,n,0),d=r.requestEdit(o),u=i.all([c,d]);u.then(function(){l.setContent("重设成功","success"),t.reload()},function(){l.setContent("重设失败","error")})["finally"](function(){l.hide()})}},e.funcRedoForm=function(e){var n=window.confirm("确定要重做表单吗？\n注意：将表单置为可编辑状态");if(n){l.setContent("正在重置表单编辑状态","inProgress"),l.show();var o=r.requestEdit(e),s=i.all([o]);s.then(function(){l.setContent("重设成功","success"),t.reload()},function(){l.setContent("重设失败","error")})["finally"](function(){l.hide()})}},e.funcRedoCheck=function(e,n){var o=window.confirm("确定要重做审核吗？\n注意：重做会取消审核结论");if(o){l.setContent("正在重设审核状态","inProgress"),l.show();var r=s.updateProcessNodeCheckStatus(e,n,0),a=i.all([r]);a.then(function(){l.setContent("重设成功","success"),t.reload()},function(){l.setContent("重设失败","error")})["finally"](function(){l.hide()})}},e.funcUpdateProcessNodeConclusion=function(e,n,i){i=angular.toJson(i),l.setContent("正在提交检验结论修改","inProgress"),l.show(),s.updateProcessNodeConclusion(e,n,i).then(function(){l.setContent("修改成功","success")},function(e){l.setContent("修改失败","error"),console.log(e)})["finally"](function(){l.hide(),o(function(){t.reload()},1e3)})}}]).controller("ProcessDetailFormCtrl",["$scope","$rootScope","$timeout","$state","$q","$window","$interval","ProcessSvc","FormSvc","cmNavBarService","cmLoadingSvc",function(e,t,n,o,i,s,r,a,c,l,d){e.state=o,e.stateParams=o.params,e.uiIsEditTags=!1,e.uiIsDataLoaded=!1,e.uiIsAutoSaveFormData=!1,e.uiIsReferencePanelShow=!0,e.uiIsReferenceShow=!1,e.uiIsFormStatusEditable=!0,e.option={all:{isEditable:!0},table:{isSortable:!1}},e.formInfo={},e.formData={},e.formConfig={},function(){d.setContent("正在加载表单"),d.show();var t=c.fetchForm(o.params.FormId),n=c.fetchFormData(o.params.FormId),s=c.fetchFormConfig(o.params.FormId),r=i.all([t,n,s]);r.then(function(t){e.formInfo=t[0],e.formData=t[1],e.formConfig=t[2],console.log(JSON.stringify(e.formConfig))},function(){d.setContent("加载失败")})["finally"](function(){d.hide()})}(),e.references=[],e.referencesProvider={},e.currentReference={},e.funcSwitchReferencePanel=function(){e.uiIsReferencePanelShow=!e.uiIsReferencePanelShow},e.uiCurrentActiveReferenceIndex=null,e.funcSwitchReference=function(t){t===e.uiCurrentActiveReferenceIndex?(console.log("same"),e.uiIsReferenceShow=!e.uiIsReferenceShow,e.uiCurrentActiveReferenceIndex=null):(e.currentReference=e.references[t],e.uiIsReferenceShow=!0,e.uiCurrentActiveReferenceIndex=t)},e.funcHideReference=function(){e.uiIsReferenceShow=!1},e.funcSideSaveForm=function(){2===parseInt(e.formInfo.Status)&&(e.option.all.isEditable=!1,e.funcSaveToServer())},e.funcSideEditForm=function(){e.option.all.isEditable=!0},e.funcSideViewForm=function(){e.option.all.isEditable=!1,e.uiIsEditTags=!1},e.funcRedoForm=function(e){var t=window.confirm("确定要重做表单吗？\n注意：将表单置为可编辑状态");if(t){d.setContent("正在重置表单编辑状态","inProgress"),d.show();var n=c.requestEdit(e),s=i.all([n]);s.then(function(){d.setContent("重设成功","success"),o.reload()},function(){d.setContent("重设失败","error")})["finally"](function(){d.hide()})}},e.funcSaveToServer=function(){console.log(e.formData),d.setContent("正在保存到服务器","inProgress"),d.show(),c.saveFormDataToServer(o.params.FormId,e.formData,!1).then(function(){d.setContent("表单数据保存成功！","success")},function(e){d.setContent("保存失败","error")})["finally"](function(){d.hide(750)})},e.funcSubmitForm=function(){var t=function(){var t=e.formInfo;"收货"===t.TypeClass?o.go("home.process.formList",{Class:t.TypeClass,ProcessTypeId:t.ProcessTypeId,Rev:t.Rev,ProcessNodeTypeId:t.ProcessNodeTypeId}):o.go("home.process.processList",{Class:t.TypeClass,ProcessTypeId:t.ProcessTypeId,Rev:t.Rev})},i=s.confirm("是否确认提交？");console.log(1),i===!0&&(d.setContent("校验失败，请检查是否有漏填，错填"),d.show(),d.hide(1500),d.setContent("正在提交表单"),d.show(),c.saveFormDataToServer(o.params.FormId,e.formData,!1).then(function(){"ARRIVAL"===o.params.ArrivalSerialNumber?c.requestSubmitAndAddToArrivalAndAddToProcess(o.params.FormId).then(function(){d.setContent("提交成功，即将转跳回列表","success"),n(function(){t(),d.hide(1e3)},2e3)},function(e){d.setContent("提交失败","error"),console.log(e),d.hide()}):c.requestSubmit(o.params.FormId).then(function(){d.setContent("提交成功，即将转跳回列表","success"),t()},function(e){d.setContent("提交失败","error"),console.log(e),d.hide()})},function(e){console.error(e),d.setContent("欲提交表单保存失败")}))};var u=function(t){return r(function(){e.uiIsAutoSaveFormData=!0,c.saveFormDataToServer(o.params.FormId,e.formData,!0).then(function(){},function(e){})["finally"](function(){e.uiIsAutoSaveFormData=!1})},t)}(12e4);e.$on("$destroy",function(){u&&r.cancel(u)})}]).controller("ProcessListBlankCtrl",["$scope","$state","AccountSvc",function(e,t,n){e.uiIsProcessTypesShow=!1;var o=function(e){"收货"===t.params.Class?t.go("home.process.formList",{Class:t.params.Class,ProcessTypeId:e.ProcessTypeId,Rev:e.Rev,ProcessNodeTypeId:"AR01"}):t.go("home.process.processList",{Class:t.params.Class,ProcessTypeId:e.ProcessTypeId,Rev:e.Rev})},i=n.getUserSetting("UserSetting.UI.Process.List.DefaultProcessType")[t.params.Class];o(i),e.funcSetDefaultProcessType=function(e,s){i.Enable=!0,i.ProcessTypeId=e,i.Rev=s;var r=n.getUserSetting("UserSetting.UI.Process.List.DefaultProcessType");r[t.params.Class]=i,n.setUserSetting("UserSetting.UI.Process.List.DefaultProcessType",r),o(i)}}]),angular.module("RMI.PlayCtrls",[]).controller("PlaygroundCtrl",function(){var e=this;e.options={},e.fields=[{wrapper:"flex-rows",fieldGroup:[{wrapper:["flex-rows","label-left","border-top-right-left"],templateOptions:{label:"送样品部门"},fieldGroup:[{className:"row cmFormCollection border-top border-bottom border-left border-bottom",fieldGroup:[{className:"col-md-3",fieldGroup:[{template:"材料名称"},{template:"供应商"},{template:"到料日期"},{template:"品牌/系列名"}]},{className:"col-md-3",fieldGroup:[{type:"input"},{type:"input"},{type:"input"},{type:"input"}]},{className:"col-md-3",fieldGroup:[{template:"材料名称"},{template:"供应商"},{template:"到料日期"},{template:"品牌/系列名"}]},{className:"col-md-3",fieldGroup:[{type:"input"},{type:"input"},{type:"input"},{type:"input"}]}]},{className:"row cmFormCollection border-top",fieldGroup:[{wrapper:"label-colon",templateOptions:{label:"用途"},fieldGroup:[{className:"row",template:"用于面布，用于面布，用于面布，用于面布，"}]},{wrapper:"label-colon",templateOptions:{label:"模压条件"},fieldGroup:[{className:"row",template:"上模温度，下模温度，用于面布，用于面布，"},{className:"row",template:"上模温度，下模温度，用于面布，用于面布，"},{template:"送检人/日期"}]}]}]}]},{wrapper:"heading",template:"材料模压测试报告"}]}).controller("PlayBuildCtrl",["$scope",function(e){}]),angular.module("RMI.HomeCtrls",[]).controller("HomeCtrl",["$scope","$rootScope","$state",function(e,t,n){}]).controller("IndexCtrl",["$scope","$http","$interval","AccountSvc","LoginSvc","FormSvc","ProcessSvc","$state","cmLoadingSvc","VERSION","cmLoginSvc",function(e,t,n,o,i,s,r,a,c,l,d){e.version="VERSION: "+l,e.currentUser=o.currentUser(),e.currentTime=new Date,e.quickGoProcessASN="";var u=n(function(){e.currentTime=new Date},1e3);e.funcAddArrivalForm=function(){c.setContent("收货报告创建中"),c.show(),s.requestCreate("ARRIVAL","ARRIVAL",0,"AR01").then(function(e){a.go("home.process.detailForm",{ArrivalSerialNumber:e.ArrivalSerialNumber,FormId:e.Id,Mode:"edit"})},function(e){c.setContent("创建过程发生错误，请检查网络连接"),console.log(e)})["finally"](function(){c.hide(750)})},e.funcQuickGoProcess=function(e){c.setContent("查询中...","inProgress"),c.show();var t=function(e){var t=/[0-9a-fA-F]{6}/;return t.test(e)};t(e)?r.fetchProcess(e).then(function(){c.setContent("转跳中..."),a.go("home.process.detailInfo",{ArrivalSerialNumber:e})},function(){c.setContent("该流水号不存在！")})["finally"](function(){c.hide()}):(c.setContent("流水号输入错误！","error"),c.hide())},e.$on("$destroy",function(){u&&n.cancel(u)})}]),angular.module("RMI.ControlCtrls",[]).controller("ControlBaseCtrl",["$scope","$rootScope","$state",function(e,t,n){e.uiIsInDesignCacheEdit=!1,e.state=n,t.$on("$stateChangeStart",function(t,n,o){e.uiIsInDesignCacheEdit=!!o.isEditCache})}]).controller("ControlDesignProcessCtrl",["$scope","$state","$q","cmLoadingSvc","ControlDesignSvc",function(e,t,n,o,i){e.processTypes=[],e.processTypes=[{Id:"X01",Class:"辅料",Name:"部件",Description:"描述信息描述信息描述信息描述信息描述信息描述信息"}],function(){o.setContent("正在加载所有流程列表","inProgress"),o.show(),i.fetchProcessTypes().then(function(t){e.processTypes=t,o.setContent("加载成功","success")},function(){o.setContent("加载失败")})["finally"](function(){o.hide(750)})}(),e.funcEditProcess=function(e,s){o.setContent("正在加载流程数据","inProgress"),o.show();var r=i.fetchProcessType(e,s),a=i.fetchProcessNodeTypes(e,s),c=n.all([r,a]);c.then(function(e){var n=e[0],s=e[1];angular.forEach(s,function(e){e.FormConfig=angular.fromJson(e.FormConfig)}),i.saveCacheConfig("process",s,n),o.setContent("加载完成","success"),t.go("home.control.designEditProcess",{isEditCache:"cache",loadItemType:void 0})},function(e){o.setContent("数据加载错误","error"),console.log(e)})["finally"](function(){o.hide(750)})}}]).controller("ControlDesignEditCtrl",["$scope","$state","$filter","$q","ControlDesignSvc","FormSvc","cmLoadingSvc",function(e,t,n,o,i,s,r){e.uiIsTable=!1,e.uiIsMap=!1,e.uiIsTableTemplateBaseShow=!1,e.uiIsMapTemplateBaseShow=!1,e.uiIsAddPanelShow=!1,e.uiIsEditCache=t.params.isEditCache?!0:!1;var a=i.getPresetConfig();e.configString="";var c="";"home.control.designEditMap"===t.current.name?(e.uiIsTable=!1,e.uiIsMap=!0,c="map"):"home.control.designEditTable"===t.current.name?(e.uiIsTable=!0,e.uiIsMap=!1,c="table"):"home.control.designEditForm"===t.current.name?c="form":"home.control.designEditProcess"===t.current.name&&(c="process"),e.generalConfig=a.general[c],e.itemConfig=a.item[c],e.itemConfigs=[],e.localConfigs=[],e.localConfigs=[{description:(new Date).getTime()},{description:(new Date).getTime()},{description:(new Date).getTime()}],function(n){if(!n)return 0;var o=i.getCacheConfig(c);angular.extend(e.generalConfig,o.content.general),angular.extend(e.itemConfigs,o.content.items),angular.extend(e.itemConfig,o.content.item);var s=t.params.loadItemType;("form"===s||"table"===s||"map"===s)&&angular.extend(e.itemConfig,i.getCacheItemConfigByChildConfig(s))}(!!t.params.isEditCache),e.funcSaveConfigsCacheAndBack=function(){if(r.setContent("正在保存编辑后的配置","inProgress"),r.show(),i.saveCacheConfig(c,e.itemConfigs,e.generalConfig),"map"===c||"table"===c)t.go("home.control.designEditForm",{isEditCache:"cache",loadItemType:c}),r.hide(750);else if("form"===c)t.go("home.control.designEditProcess",{isEditCache:"cache",loadItemType:c}),r.hide(750);else if("process"===c){var n=i.updateProcessType(e.generalConfig.Id,e.generalConfig),s=i.updateProcessNodeTypes(e.generalConfig.Id,e.itemConfigs),a=o.all([n,s]);a.then(function(){r.setContent("保存成功","success"),t.go("home.control.designProcess",{isEditCache:"cache"})},function(e){console.log(e),r.setContent("保存失败","error")})["finally"](function(){r.hide(750)})}};var l=null;e.funcLoadItemConfigToAddPanel=function(t,n){l=n,e.itemConfig=angular.copy(t),console.log("Current Editing:"+n)};var d=function(n){i.saveCacheConfig(c,e.itemConfigs,e.generalConfig,null),{form:function(){t.go("home.control.designEditForm",{isEditCache:"cache"})},table:function(){t.go("home.control.designEditTable",{isEditCache:"cache"})},map:function(){t.go("home.control.designEditMap",{isEditCache:"cache"})}}[n]()};e.funcGoEditItemConfig=function(t){var n=e.itemConfig,o=l;if(n)if("process"===c)i.saveItemCacheConfig("process",n),i.saveCacheConfigByFatherConfig(n,"form",o);else if("form"===c){i.saveItemCacheConfig("form",n);var s=n.Type;"table"===s?i.saveCacheConfigByFatherConfig(n,"table",o):"map"===s&&i.saveCacheConfigByFatherConfig(n,"map",o)}d(t)},e.funcGoCreateItemConfig=function(e){d(e)},e.funcPackFormConfigString=function(e){var t=angular.fromJson(e),n={FormConfig:t};return angular.toJson(n)},e.funcLoadConfig=function(t){var n=angular.fromJson(t);angular.forEach(n,function(t,n){e.itemConfig[n]=t})},e.funcAddUpConfigs=function(){e.itemConfig.Order=e.itemConfigs.length+1,e.itemConfigs.push(angular.copy(e.itemConfig)),e.itemConfig=a.item[c]},e.funcReorderConfigs=function(){e.itemConfigs=n("orderBy")(e.itemConfigs,"Order"),angular.forEach(e.itemConfigs,function(e,t){e.Order=t+1})},e.funcDeleteFromConfigs=function(t){e.itemConfigs.splice(t,1)},e.funcAddProcessTypeIdToConfigs=function(){angular.forEach(e.itemConfigs,function(t){t.ProcessTypeId=e.generalConfig.Id,t.Rev=e.generalConfig.Rev})},e.funcAddDatabaseTableNameToFormConfigs=function(){var t="RMI_FORM_DATA_PROCESSTYPEID_REVREPLACE_REV_PROCESSNODETYPEID_COMPONENTORDER_TYPE";angular.forEach(e.itemConfigs,function(e){if("object"==typeof e.FormConfig){var n=t.replace(/PROCESSTYPEID/g,e.ProcessTypeId).replace(/PROCESSNODETYPEID/g,e.Id).replace(/REPLACE_REV/g,e.Rev);angular.forEach(e.FormConfig.Components,function(e){e.DatabaseTableName=n.replace(/ORDER/g,e.Order).replace(/TYPE/g,e.Type.toUpperCase())})}})},e.funcCreateProcessTypeAndProcessNodeTypes=function(){r.setContent("正在提交流程数据"),r.show(),e.funcAddProcessTypeIdToConfigs(),e.funcAddDatabaseTableNameToFormConfigs();var t=e.generalConfig,n=e.itemConfigs;angular.forEach(n,function(e){"string"!=typeof e.FormConfig,"number"==typeof e.Order&&(e.Order=e.Order.toString())});var s=i.createProcessType(t);console.log(n);var a=i.createProcessNodeTypes(n),c=o.all([s,a]);
c.then(function(){r.setContent("提交成功！")},function(e){r.setContent("提交失败"),console.log("funcCreateProcessTypeAndProcessNodeTypes Error:"+e)})["finally"](function(){r.hide(750)})}}]).controller("ControlDesignClassificationCtrl",["$scope","$state","SQLQuerySvc","ControlDesignSvc","cmLoadingSvc",function(e,t,n,o,i){e.uiIsAddPanelShow=!1,e.OptionalProcessTypes=[],e.subclasses=[],e.subclass={Subclass:null,ProcessTypeId:null},e.funcSubmitSubclass=function(e){i.setContent("Creating subclass...","inProgress"),i.show(),console.log(e),e.Subclass&&e.ProcessTypeId?o.createSubclass(e).then(function(){i.setContent("Successfully.","success"),t.reload()},function(e){i.setContent("Error.","error"),console.error(e)})["finally"](function(){i.hide()}):(i.setContent("Config error, please check.","error"),i.hide(1e3))},e.funcRemoveSubclass=function(e){i.setContent("Deleting subclass...","inProgress"),i.show(),o.deleteSubclass(e).then(function(){i.setContent("Successfully.","success"),t.reload()},function(e){i.setContent("Error.","error"),console.error(e)})},function(){o.fetchProcessTypes().then(function(t){e.OptionalProcessTypes=t},function(){}),o.fetchSubclasses().then(function(t){e.subclasses=t})}()}]).controller("ControlDesignSourceCtrl",["$scope","ControlDesignSvc","cmLoadingSvc",function(e,t,n){e.uiIsAddPanelShow=!0,e.config={Description:"",Name:"",Type:"value",Value:""},e.configs=[],e.funcReadSources=function(){n.setContent("正在加载数据","inProgress"),n.show(),t.readSourcesFromKVStore().then(function(t){n.setContent("加载完成","success"),e.configs=t},function(){n.setContent("加载失败","error")})["finally"](function(){n.hide(750)})},e.funcCreateSource=function(){n.setContent("正在创建来源","inProgress"),n.show(),t.createSourceToKVStore(e.config).then(function(t){n.setContent("数据成功获取，重载页面值","success"),e.configs=t},function(e){n.setContent("创建失败","error")})["finally"](function(){n.hide(750)})},e.funcDeleteSource=function(o){n.setContent("正在删除来源","inProgress"),n.show(),t.deleteSourceFromKVStore(o).then(function(t){n.setContent("删除成功，重载页面值","success"),e.configs=t},function(e){n.setContent("删除失败","error")})["finally"](function(){n.hide(750)})},e.funcReadSources()}]).controller("ControlFeedbackCtrl",["$scope","ControlFeedbackSvc","cmLoadingSvc","AccountSvc",function(e,t,n,o){e.feedback={Subject:"",Content:"",SubmitTime:"",SubmitUserId:"",SubmitUserName:""},e.funcSubmitNewFeedback=function(e){e.SubmitTime=(new Date).getTime(),e.SubmitUserId=o.currentUser().Id,e.SubmitUserName=o.currentUser().Name,localStorage.setItem("Control.FeedBack."+(new Date).getTime(),angular.toJson(e)),n.setContent("正在提交您的反馈","inProgress"),n.show(),t.createFeedback(e).then(function(){n.setContent("感谢您提供反馈！","success")},function(e){n.setContent("服务器提交失败，已本地存储","error"),console.error(e)})["finally"](function(){n.hide(750)})}}]).controller("ControlUserCtrl",["$scope","ControlUserSvc","$uibModal",function(e,t,n){e.users=[],function(){t.fetchUsers().then(function(t){e.users=t},function(e){console.error(e)})["finally"](function(){})}(),e.emptyUser={},e.funcOpenUserModifyModal=function(t){var o=n.open({templateUrl:"app/control/user/modify.html",controller:"ControlUserModifyCtrl",resolve:{data:{user:t}}});o.result.then(function(t){e.selectedUser=t})}}]).controller("ControlUserModifyCtrl",["$scope","data",function(e,t){var n=function(){alert(JSON.stringify(e.vm.model),null,2)};e.vm={},e.vm.onSubmit=n,e.vm.model=angular.copy(t.user),e.vm.initialFieldsModel=[{className:"row",fieldGroup:[{className:"col-xs-4",type:"input",key:"Id",templateOptions:{type:"",label:"工号",required:!0,placeholder:"",description:"",options:[]}},{className:"col-xs-4",type:"input",key:"Username",templateOptions:{type:"",label:"姓名",required:!0,placeholder:"",description:"",options:[]}},{className:"col-xs-4",type:"input",key:"Password",templateOptions:{type:"password",label:"密码",required:!0,placeholder:"",description:"",options:[]}}]},{className:"row",fieldGroup:[{className:"col-xs-6",type:"groupedSelect",key:"Department",templateOptions:{type:"",label:"部门",required:!1,placeholder:"",description:"",options:[{name:"仓库管理",value:0,group:"检验"},{name:"主料检验",value:1,group:"检验"},{name:"辅料检验",value:2,group:"检验"},{name:"管理",value:3,group:"管理"}]}},{className:"col-xs-6",type:"basicSelect",key:"Job",templateOptions:{type:"",label:"职务",required:!1,placeholder:"",description:"",options:[{name:"检验员",value:0,group:""},{name:"管理员",value:1,group:""}]}}]},{className:"row",fieldGroup:[{className:"col-xs-12",type:"textarea",key:"Permission",templateOptions:{type:"",label:"权限分配JSON",required:!1,placeholder:"",description:"",options:[]}}]}],e.vm.buttons={submit:"submit",cancel:"cancel"},e.vm.fields=angular.copy(e.vm.initialFieldsModel)}]).controller("ControlOperationCtrl",["$scope","$state","FormSvc","ControlOperationSvc","AccountSvc",function(e,t,n,o,i){e.operations=[],e.funcGo=function(e,o){"form"===e?n.fetchForm(o).then(function(e){t.go("home.process.detailForm",{ArrivalSerialNumber:e.ArrivalSerialNumber,FormId:o,Mode:"edit"})},function(){})["finally"]():"process"===e&&t.go("home.process.detailInfo",{ArrivalSerialNumber:o})},function(n){e.operations=[];var i=function(e){return{GET:"获取表单内容",POST:"创建新表单",PUT:"保存表单数据"}[e]};o.fetchOperations(n,t.params.top).then(function(t){angular.forEach(t,function(e){e.Description=i(e.Method)}),e.operations=t},function(e){console.error(e)})}(i.currentUser())}]),function(){angular.module("RMI",["ngAnimate","ngCookies","ngTouch","ngMessages","ui.router","ui.bootstrap","nya.bootstrap.select","textAngular","formly","formlyBootstrap","ngTable","angular-loading-bar","RMI.PlayCtrls","RMI.HomeCtrls","RMI.ProcessCtrls","RMI.ControlCtrls","RMI.HomeServices","RMI.ProcessServices","RMI.ControlServices","RMI.UniversalServices","DEVBYCM.cmTemplateLoad","DEVBYCM.cmInput","DEVBYCM.cmSelect","DEVBYCM.cmCheckbox","DEVBYCM.cmRadio","DEVBYCM.cmToggle","DEVBYCM.cmTextarea","DEVBYCM.cmTable","DEVBYCM.cmBarcode","DEVBYCM.cmNavMenu","DEVBYCM.cmSideMenuBox","DEVBYCM.cmContentEditable","DEVBYCM.cmLoadingModule","DEVBYCM.cmNavBarModule","DEVBYCM.cmLoginModule","DEVBYCM.cmNotificationAreaModule"])}(),function(){function e(e){e.setWrapper({name:"heading",template:'<div class="cmFormCollection heading">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"fill-24",template:'<div style="height: 24px;width: 100%">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"label-left",template:'<div class="cmFormCollection label-left">\n  <div class="left-label">{{options.templateOptions.label}}</div>\n  <div class="right-separator"></div>\n  <div class="content">\n    <formly-transclude></formly-transclude>  \n  </div>\n</div>'}),e.setWrapper({name:"label-top",template:'<div class="cmFormCollection label-top">\n  <div class="top-label">{{options.templateOptions.label}}</div>\n  <div class="bottom-separator"></div>\n  <div class="content">\n    <formly-transclude></formly-transclude>\n  </div>\n</div>'}),e.setWrapper({name:"label-colon",template:'<div class="cmFormCollection label-colon">\n  <div class="colon-label">{{options.templateOptions.label}}</div>\n  <div class="content">\n    <formly-transclude></formly-transclude>  \n  </div>\n</div>'}),e.setWrapper({name:"border-top-right-left",template:'<div class="cmFormCollection border-top-right-left">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"border-bottom",template:'<div class="cmFormCollection border-bottom">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"flex-col",template:'<div class="cmFormCollection flex-col">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"flex-row",template:'<div class="cmFormCollection flex-row">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"flex-cols",template:'<div class="cmFormCollection flex-cols">\n    <formly-transclude></formly-transclude>\n</div>'}),e.setWrapper({name:"flex-rows",template:'<div class="cmFormCollection flex-rows">\n    <formly-transclude></formly-transclude>\n</div>'})}angular.module("RMI").config(e),e.$inject=["formlyConfigProvider"]}(),function(){function e(e){function t(e){return e=e.replace(/[-_s]+(.)?/g,function(e,t){return t?t.toUpperCase():""}),e.replace(/^([A-Z])/,function(e,t){return t?t.toLowerCase():""})}e.setType({name:"richEditor",template:'<text-angular class="richTextAngular" ng-model="model[options.key || index]"></text-angular>'}),e.setType({name:"blank",template:"<div></div>"});var n='<div class="row"><div class=""><h4 class="text-center">{{options.templateOptions.placeholder}}<h4><hr/></div></div>';e.setType({name:"subTitle",template:n});var o='<div><label>{{options.templateOptions.label}}</label> <ol   class="nya-bs-select col-sm-12 col-xs-12 col-md-12 col-lg12"    ng-model="model[options.key || index]"     id="{{id}}"     disabled="options.templateOptions.options.length === 0">    <li class="nya-bs-option" nya-bs-option="option in options.templateOptions.options">      <a>{{option.name}}</a>    </li>  </ol> </div>';e.setType({name:"basicSelect",template:o});var i='<div>  <label>{{options.templateOptions.label}}</label>  <ol class="nya-bs-select col-sm-12 col-xs-12 col-md-12 col-lg12"     ng-model="model[options.key || index]"        data-live-search="true"        disabled="options.templateOptions.options.length === 0">       <li nya-bs-option="option in  options.templateOptions.options group by option.group"         >         <span class="dropdown-header">{{$group}}</span>         <a>           <span>{{option.name}}</span>           <span class="glyphicon glyphicon-ok check-mark"></span>         </a>       </li>  </ol></div>';e.setType({name:"groupedSelect",template:i});var s=["date-disabled","custom-class","show-weeks","starting-day","init-date","min-mode","max-mode","format-day","format-month","format-year","format-day-header","format-day-title","format-month-title","year-range","shortcut-propagation","datepicker-popup","show-button-bar","current-text","clear-text","close-text","close-on-date-selection","datepicker-append-to-body"],r=["datepicker-mode","min-date","max-date"],a={};angular.forEach(s,function(e){a[t(e)]={attribute:e}}),angular.forEach(r,function(e){a[t(e)]={bound:e}}),e.setType({name:"datepicker",template:'<input  id="{{id}}" class="form-control" ng-click="open($event)" ng-model="model[options.key  || index]" is-open="to.isOpen" ng-click="to.isOpen = true" datepicker-options="to.datepickerOptions" />',wrapper:["bootstrapLabel","bootstrapHasError"],controller:["$scope",function(e){e.open=function(t){t.preventDefault(),t.stopPropagation(),e.opened=!0}}],defaultOptions:{ngModelAttrs:a,templateOptions:{addonLeft:{"class":"glyphicon glyphicon-calendar",onClick:function(e,t){e.templateOptions.isOpen=!e.templateOptions.isOpen}},onFocus:function(e,t,n){n.to.isOpen=!n.to.isOpen},datepickerOptions:{}}}})}angular.module("RMI").config(e),e.$inject=["formlyConfigProvider"]}(),function(){function e(e){e.setType({name:"cm-input",template:'<div class="cmFormCollection cmInput">\n  <label>\n    <div class="input-label">\n      {{options.templateOptions.label}}\n    </div>\n    <input type="{{options.templateOptions.type}}" ng-model="model[options.key]">\n  </label>\n</div>',link:function(e){}}),e.setType({name:"cm-select",template:'<div class="cmFormCollection cmSelect" style="width: {{options.templateOptions.width}}">\n  <label>\n    {{options.templateOptions.label}}\n  </label>\n  <div>\n    <div>\n      <ol class="nya-bs-select" ng-model="model[options.key || index]"\n          style="width: {{options.templateOptions.selectWidth}}"\n          title="请选择"\n          live-search="options.templateOptions.liveSearch===\'true\'"\n          disabled="options.templateOptions.options.length === 0">\n        <li ng-show="options.templateOptions.group"\n            nya-bs-option="option in  options.templateOptions.options group by option.group"\n            data-value="option.value"\n        >\n          <span class="dropdown-header">{{$group}}</span>\n          <a><span>{{option.name}}</span><span class="">1</span></a></li>\n        <li ng-show="!options.templateOptions.group"\n            nya-bs-option="option in  options.templateOptions.options"\n            data-value="option.value"\n        ><span\n          class="dropdown-header">{{$group}}</span>\n          <a><span>{{option.name}}</span><span class="">1</span></a></li>\n      </ol>\n    </div>\n  </div>\n</div>'}),e.setType({name:"cm-table",template:'<cm-formly-table model="model[options.key]" to="to" templateOptions="templateOptions"></cm-formly-table>'})}var t=1;angular.module("RMI").config(e).directive("cmFormlyTable",function(){return{restrict:"E",template:'<div class="cmFormCollection cmTable {{hideRepeat}} cm-animation-fade" style="{{uiIsEmptyTableInitial?\'min-height:163px;max-height:163px;\':\'\'}}">\n  <div class="loading-mask" ng-if="uiIsEmptyTableInitial">\n    <div class="text">Loading...</div>\n  </div>\n  <div>\n    <header class="table-head">\n      <div style="min-width: {{rowModifyClassWidth+\'px\'}};max-width: {{rowModifyClassWidth+\'px\'}};height: 100%;"></div>\n      <div class="head-cell" ng-repeat="cell in tableHeadCells track by $index" style="width: {{cell.width+\'px\'}}">\n        {{cell.name}}\n      </div>\n    </header>\n    <section class="table-body">\n      <div class="table-row" ng-repeat="element in model" ng-init="fields = funcCopyFields(to.fields)">\n        <div class="row-modify">\n          <a ng-click="funcRemoveWithConfirm($index)">删除</a>\n        </div>\n        <formly-form class="row-content" fields="fields" model="element" form="form"></formly-form>\n      </div>\n      <div class="table-row-no-content" ng-show="model.length===0">暂无内容</div>\n    </section>\n    <footer class="table-foot">\n      <div class="addNewRowButton">\n        <button type="button" class="btn btn-block btn-primary" ng-click="funcPushWithBringDown()">添加新的项目</button>\n      </div>\n    </footer>\n  </div>\n</div>',replace:!0,scope:{model:"=",to:"=",templateOptions:"="},link:function(e,t){var n=function(){setTimeout(function(){e.rowModifyClassWidth=$($(t).find(".row-modify")[0]).outerWidth(!0);var n=$(t).find(".formly")[0],o=$(n).find(".formly-field");e.tableHeadCells=o.map(function(){return{width:$(this).outerWidth(!0)}}).get(),angular.forEach(e.tableHeadCells,function(t,n){var o=e.to.fields[n].key;angular.forEach(e.to.relation,function(e){e.key===o&&(t.name=e.name)})}),e.$digest()},0)};$(window).bind("resize",function(){t.ready(function(){n()})}),setInterval(function(){t.ready(function(){n()})},750),e.$watch(function(){return angular.isUndefined(e.model)?0:e.model.length},function(){e.uiIsLoading=!0,setTimeout(function(){var n=$(t).find(".formly");n.map(function(o){$(this).find(".formly-field").map(function(){var i=$(this).next();$(this).find("input").unbind("keypress"),$(this).find("input").bind("keypress",function(s){var r=function(o,i){i-1>=o?$(n[o+1]).find(".formly-field").find("input").first().focus():(e.funcPushWithBringDown(),e.$apply(),a=$(t).find(".formly"),$(a[o+1]).find(".formly-field").find("input").first().focus())},a=null;if(s.ctrlKey===!0&&10===s.keyCode)s.preventDefault(),r(o,n.length-1);else if(13===s.keyCode){s.preventDefault();var c=i.find("input");c.length?c.focus():r(o,n.length-1)}})})}),setTimeout(function(){e.uiIsLoading=!1,e.$digest()},0)},0)}),e.uiIsEmptyTableInitial=!e.model,e.uiIsLoading=!0,e.funcPush(),setTimeout(function(){n(),e.funcPop(),e.uiIsEmptyTableInitial=!1,setInterval(function(){e.uiIsInitial=!1},0)},0)},controller:["$scope",function(e){function n(e){return e=angular.copy(e),o(e),e}function o(e){t++,angular.forEach(e,function(e,n){return e.fieldGroup?void o(e.fieldGroup):(e.templateOptions&&e.templateOptions.fields&&o(e.templateOptions.fields),void(e.id=e.id||e.key+"_"+n+"_"+t+i(0,9999)))})}function i(e,t){return Math.floor(Math.random()*(t-e))+e}e.formOptions={formState:e.formState},e.funcRemoveWithConfirm=function(t){var n=confirm("您确定要删除这一项吗？");n&&e.funcRemove(t)},e.funcRemove=function(t){e.model.splice(t,1)},e.funcPop=function(){e.model.pop()},e.funcPush=function(){e.model=e.model||[],e.model.push({})},e.funcPushWithBringDown=function(){e.model=e.model||[];var t=e.model,n=t[t.length-1],o={};n&&angular.forEach(e.to.bringDown,function(e){n[e.key]&&(o[e.key]=angular.copy(n[e.key]))}),t.push(o)},e.funcCopyFields=n}]}}),e.$inject=["formlyConfigProvider"]}(),function(){function e(e){e.debug("runBlock end")}angular.module("RMI").run(e),e.$inject=["$log"]}(),function(){function e(e,t){e.state("home",{url:"/",views:{"":{templateUrl:"app/interaction/dashboard/index.html",controller:"HomeCtrl"},"main@home":{templateUrl:"app/interaction/dashboard/main.html",controller:"IndexCtrl"}}}).state("home.playground",{url:"Playground",views:{"main@home":{templateUrl:"app/interaction/playground/main.html",controller:"PlaygroundCtrl",controllerAs:"vm"}}}).state("home.process",{"abstract":!0,url:"Ins",views:{"main@home":{template:'<div ui-view=""></div>'}}}).state("home.process.detailInfo",{url:"/:ArrivalSerialNumber/Info/",templateUrl:"app/interaction/process/detail/info.html",controller:"ProcessDetailInfoCtrl"}).state("home.process.detailForm",{url:"/:ArrivalSerialNumber/Form/:FormId/?Mode",templateUrl:"app/interaction/process/detail/base.html",controller:"ProcessDetailFormCtrl"}).state("home.process.formList",{url:"/:Class/F/:ProcessTypeId-:Rev/:ProcessNodeTypeId/?IsComplete",templateUrl:"app/interaction/process/list/base.html",controller:"ProcessListCtrl"}).state("home.process.processList",{url:"/:Class/P/:ProcessTypeId-:Rev/?IsComplete",templateUrl:"app/interaction/process/list/base.html",controller:"ProcessListCtrl"}).state("home.control",{"abstract":!0,url:"Control",views:{"main@home":{templateUrl:"app/interaction/control/base.html",controller:"ControlBaseCtrl"}}}).state("home.control.designProcess",{url:"/design/process/",templateUrl:"app/interaction/control/design/process.html",controller:"ControlDesignProcessCtrl"}).state("home.control.designEditProcess",{url:"/design/edit/process/?isEditCache&loadItemType",templateUrl:"app/interaction/control/design/edit/process.html",controller:"ControlDesignEditCtrl"}).state("home.control.designEditForm",{url:"/design/edit/form/?isEditCache&loadItemType",templateUrl:"app/interaction/control/design/edit/form.html",controller:"ControlDesignEditCtrl"}).state("home.control.designEditTable",{url:"/design/edit/table/?isEditCache",templateUrl:"app/interaction/control/design/edit/table.html",controller:"ControlDesignEditCtrl"}).state("home.control.designEditMap",{url:"/design/edit/map/?isEditCache",templateUrl:"app/interaction/control/design/edit/map.html",controller:"ControlDesignEditCtrl"}).state("home.control.designClassification",{url:"/design/classification/",templateUrl:"app/interaction/control/design/classification.html",controller:"ControlDesignClassificationCtrl"}).state("home.control.designSource",{url:"/design/source/",templateUrl:"app/interaction/control/design/source.html",controller:"ControlDesignSourceCtrl"}).state("home.control.feedbackNew",{url:"/feedback/new/",templateUrl:"app/interaction/control/feedback/new.html",controller:"ControlFeedbackCtrl"}).state("home.control.user",{url:"/user/",templateUrl:"app/interaction/control/user/all.html",controller:"ControlUserCtrl"}).state("home.control.operationRecord",{url:"/operation/record/?top",templateUrl:"app/interaction/control/operation/record.html",controller:"ControlOperationCtrl"}),t.otherwise("/")}angular.module("RMI").config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){angular.module("RMI").constant("malarkey",malarkey).constant("moment",moment).constant("SERVER_URL","http://192.168.1.240:8000/api/").constant("VERSION","1512.22.218")}(),function(){angular.module("RMI").config(["cfpLoadingBarProvider",function(e){e.includeSpinner=!1,e.includeBar=!0}]).config(["nyaBsConfigProvider",function(e){e.setLocalizedText("zh-cn",{defaultNoneSelection:"",noSearchResult:"没有结果",numberItemSelected:"选中%d项"}),e.useLocale("zh-cn")}])}(),angular.module("DEVBYCM.cmTemplateLoad",[]).directive("cmTemplateLoad",["UtilSvc","$templateCache",function(e,t){return{restrict:"E",template:'<div ng-include="templateUrl"></div>',scope:{model:"=",template:"@"},replace:!0,link:function(n){n.templateUrl="cmTemplateLoad"+e.random(16,8,!0,!1)+".html",t.put(n.templateUrl,n.template),n.$on("$destroy",function(){t.remove(n.templateUrl)})}}}]),angular.module("DEVBYCM.cmContentEditable",[]).directive("cmcontenteditable",["$timeout",function(e){return{restrict:"A",require:"?ngModel",terminal:!0,link:function(t,n,o,i){if(i){var s={};angular.forEach(["stripBr","noLineBreaks","selectNonEditable","moveCaretToEndOnChange"],function(e){var t=o[e];s[e]=t&&"false"!==t}),n.bind("input",function(o){t.$apply(function(){var t,o,r;t=n.html(),r=!1,s.stripBr&&(t=t.replace(/<br>$/,"")),s.noLineBreaks&&(o=t.replace(/<div>/g,"").replace(/<br>/g,"").replace(/<\/div>/g,""),o!==t&&(r=!0,t=o)),i.$setViewValue(t),r&&i.$render(),""===t&&e(function(){n[0].blur(),n[0].focus()})})});var r=i.$render;i.$render=function(){var e,t,o,a;r&&r(),n.html(i.$viewValue||""),s.moveCaretToEndOnChange&&(e=n[0],o=document.createRange(),a=window.getSelection(),e.childNodes.length>0?(t=e.childNodes[e.childNodes.length-1],o.setStartAfter(t)):o.setStartAfter(e),o.collapse(!0),a.removeAllRanges(),a.addRange(o))},s.selectNonEditable&&n.bind("click",function(e){var t,n,o;o=e.toElement,o!==this&&"false"===angular.element(o).attr("contenteditable")&&(t=document.createRange(),n=window.getSelection(),t.setStartBefore(o),t.setEndAfter(o),n.removeAllRanges(),n.addRange(t))})}}}}]),angular.module("DEVBYCM.cmBarcode",[]).directive("cmBarcode",function(){return{restrict:"E",template:'<img src="">',scope:{value:"="},replace:!0,link:function(e,t){var n={width:2,height:80,quite:0,format:"CODE128",displayValue:!0,font:"Consolas",textAlign:"center",fontSize:17,backgroundColor:"",lineColor:"#000"};e.$watch(function(){return e.value},function(e){e&&JsBarcode(t[0],e,n)},!0)}}}),angular.module("DEVBYCM.cmToggle",[]).directive("cmToggle",["UtilSvc",function(e){return{restrict:"E",template:'<div class="cmFormCollection cmToggle">\n  <label>\n    {{label}}<input type="checkbox" ng-model="model">\n  </label>\n</div>',scope:{model:"=",label:"@"},replace:!0,link:function(e,t){}}}]),angular.module("DEVBYCM.cmTextarea",[]).directive("cmTextarea",function(){return{restrict:"E",template:'<div class="cmFormCollection cmTextarea">\n  <label>\n    <textarea ng-model="model"></textarea>\n  </label>\n</div>',scope:{model:"=",required:"="},replace:!0,link:function(e,t){}}}),angular.module("DEVBYCM.cmTable",[]).directive("cmTable",function(){return{restrict:"E",template:"<table>\n  <thead></thead>\n  <tbody></tbody>\n  <tfoot></tfoot>\n</table>",scope:{},replace:!0,link:function(e,t){}}}),angular.module("DEVBYCM.cmSelect",[]).directive("cmSelect",function(){return{restrict:"E",template:'<div class="cmFormCollection cmSelect" style="width: {{width}}">\n  <label>\n    {{label}}\n  </label>\n  <div>\n    <div>\n      <ol class="nya-bs-select" ng-model="model"\n          style="width: {{selectWidth}}"\n          title="请选择"\n          live-search="liveSearch===\'true\'"\n          disabled="options.length === 0">\n        <li ng-show="group"\n            nya-bs-option="option in  options group by option.group"\n            data-value="option.value"\n        >\n          <span class="dropdown-header">{{$group}}</span>\n          <a><span>{{option.name}}</span><span class="">1</span></a></li>\n        <li ng-show="!group"\n            nya-bs-option="option in  options"\n            data-value="option.value"\n        ><span\n          class="dropdown-header">{{$group}}</span>\n          <a><span>{{option.name}}</span><span class="">1</span></a></li>\n      </ol>\n    </div>\n  </div>\n</div>',scope:{model:"=",options:"=",width:"@",label:"@",liveSearch:"@"},replace:!0,link:function(e,t){}}}),angular.module("DEVBYCM.cmRadio",[]).directive("cmRadio",["UtilSvc",function(e){return{restrict:"E",template:'<div class="cmFormCollection cmRadio">\n  <label ng-repeat="option in options">\n    <input type="radio" name="{{name}}" ng-init="value[$index]=model" ng-model="value[$index]" ng-click="funcUpdateModel(value[$index])" ng-value="option">{{option}}\n  </label>\n</div>',scope:{model:"=",options:"="},replace:!0,link:function(t,n){t.name=e.random(16,8,!0,!1),t.funcUpdateModel=function(e){t.model=e}}}}]),angular.module("DEVBYCM.cmInput",[]).directive("cmInput",function(){return{restrict:"E",template:'<div class="cmFormCollection cmInput">\n  <label>\n    <input type="{{type}}" ng-model="model" required="{{required}}">\n  </label>\n</div>',scope:{model:"=",type:"@",required:"="},replace:!0,link:function(e,t){}}}),angular.module("DEVBYCM.cmCheckbox",[]).directive("cmCheckbox",["UtilSvc",function(e){return{restrict:"E",template:'<div class="cmFormCollection cmCheckbox">\n  <label ng-repeat="option in options">\n    <input type="checkbox" ng-model="value[$index]" ng-click="funcUpdateModel(value[$index],index,option)" ng-value="option">{{option}}\n  </label>\n</div>',scope:{model:"=",options:"="},replace:!0,link:function(t){angular.isArray(t.model)||(t.model=[]),t.name=e.random(16,8,!0,!1);var n=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;console.log("Cant find item in the array.")};t.funcUpdateModel=function(e,o,i){e?t.model.push(i):angular.isNumber(n(t.model,i))&&t.model.splice(n(t.model,i),1)}}}}]),angular.module("RMI.UniversalServices",[]).factory("UtilSvc",function(){return{random:function(e,t,n,o){if(1>e||e>36||0>t||t>16)return console.log("UtilSvc.random Error: radix="+e+" digit="+t+" isUppercase="+n+" isFillZero="+o),-1;var i=Math.round(Math.random()*Math.pow(e,t)).toString(e).toLowerCase();return n&&(i=i.toUpperCase()),o&&i.length!==t-1&&(i+=new Array(t-i.length).join("0")),i}}}).factory("KVStoreSvc",["$rootScope","$q","$http","SERVER_URL",function(e,t,n,o){var i=o+"kvstore/";return{create:function(e,o){var s=t.defer();return n.post(i+e+"/",angular.toJson(o)).success(function(e){s.resolve(angular.fromJson(e))}).error(function(e){s.reject(e)}),s.promise},read:function(e){var o=t.defer();return n.get(i+e+"/").success(function(e){o.resolve(angular.fromJson(e))}).error(function(e){o.reject(e)}),o.promise},update:function(e,o){var s=t.defer();return n.put(i+e+"/",angular.toJson(o)).success(function(e){s.resolve(angular.fromJson(e))}).error(function(e){s.reject(e)}),s.promise},"delete":function(e){var o=t.defer();return n["delete"](i+e+"/").success(function(e){o.resolve(angular.fromJson(e))}).error(function(e){o.reject(e)}),o.promise}}}]).factory("SQLQuerySvc",["$q","$http","SERVER_URL",function(e,t,n){return{query:function(o){var i=e.defer();return t.get(n+"sqlquery",{params:{sql:o}}).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise}}}]),angular.module("RMI.ProcessServices",[]).factory("FormSvc",["$http","$rootScope","$state","$timeout","$q","SERVER_URL",function(e,t,n,o,i,s){return{stateParamsToFormTypeId:function(e){return{daohuo:{shouhuobaogao:"A01"},zhuliao:{waiguan:"B01",lihua:"B02",shimoya:"B03",yanseshougan:"B04",zhuliaoruku:"B05"},fuliao:{shangbiao:"C01",bugantie:"C02",zhika:"C03",huabian:"C04",goupan:"C05",tiaojiekou:"C06",jiandai:"C07",songjindai:"C08"}}[e["class"]][e.type]},fetchForms:function(t,n,o){var r=i.defer();return e.get(s+"forms/",{params:{ProcessTypeId:t,Rev:n,ProcessNodeTypeId:o}}).success(function(e){angular.forEach(e,function(e){e.Parameter&&angular.isString(e.Parameter)&&(e.Parameter=angular.fromJson(e.Parameter))}),r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},fetchForm:function(t){var n=i.defer();return e.get(s+"forms/"+t+"/").success(function(e){e.Parameter&&angular.isString(e.Parameter)&&(e.Parameter=angular.fromJson(e.Parameter)),n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},fetchFormData:function(t){var n=i.defer();return e.get(s+"forms/"+t+"/data/").success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},fetchFormConfig:function(t){var n=i.defer();return e.get(s+"forms/"+t+"/config/").success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},saveFormDataToServer:function(t,n,o){var r=i.defer();return e.put(s+"forms/"+t+"/data/",n,{params:{autoSave:o}}).success(function(){r.resolve()}).error(function(e){r.reject(e)}),r.promise},requestCreate:function(t,n,o,r){var a=i.defer();return e.post(s+"forms/",{ArrivalSerialNumber:t,create:"true",ProcessTypeId:n,Rev:0,ProcessNodeTypeId:r,Status:"2"}).success(function(e){a.resolve(e)}).error(function(e){a.reject(e)}),a.promise},requestCancelEdit:function(t){var n=i.defer();return e.post(s+"forms/"+t+"/",{Status:"1"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestEdit:function(t){var n=i.defer();return e.post(s+"forms/"+t+"/",{Status:"2"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestConfirm:function(t){var n=i.defer();return e.post(s+"forms/"+t+"/",{Status:"3"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestSubmit:function(t){var n=i.defer();return e.post(s+"forms/"+t+"/",{Status:"4"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestAddToArrival:function(t){var n=i.defer();return e.post(s+"forms/"+t+"/",{addToArrival:"true"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestAddToArrivalAndAddToProcess:function(t){var n=i.defer();return e.post(s+"forms/"+t+"/",{addToArrivalAndAddToProcess:"true"}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},requestSubmitAndAddToArrival:function(t){var n=this,o=i.defer();return e.post(s+"forms/"+t+"/",{Status:"4"}).success(function(e){n.requestAddToArrival(t).then(function(){o.resolve(e)},function(e){o.reject(e)})}).error(function(e){o.reject(e)}),o.promise},requestSubmitAndAddToArrivalAndAddToProcess:function(t){var n=this,o=i.defer();return e.post(s+"forms/"+t+"/",{Status:"4"}).success(function(){n.requestAddToArrivalAndAddToProcess(t).then(function(e){o.resolve(e)},function(e){o.reject(e)})}).error(function(e){o.reject(e)}),o.promise},updateFormTags:function(t,n){var o=i.defer();return e.put(s+"forms/"+t+"/tags/",n).success(function(e){o.resolve(angular.fromJson(e))}).error(function(e){o.reject(e)}),o.promise}}}]).factory("ProcessSvc",["SERVER_URL","$q","$http",function(e,t,n){var o=function(e){return angular.forEach(e,function(e){angular.forEach(e.Nodes,function(e){angular.isArray(e.Form.Tags)||(e.Form.Tags=angular.fromJson(e.Form.Tags))})}),e};return{_DEPRECATED_fetchArrivals:function(o){var i=t.defer();return n.get(e+"arrivals/",{params:{Class:o}}).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise},_DEPRECATED_fetchProcessesByClass:function(i){var s=t.defer();return n.get(e+"processes/",{params:{Class:i}}).success(function(e){s.resolve(o(e))}).error(function(e){s.reject(e)}),s.promise},_DEPRECATED_requestAddToProcess:function(o){var i=t.defer();return n.post(e+"arrivals/"+o+"/",{addToProcess:"true"}).success(function(){i.resolve()}).error(function(e){i.reject(e)}),i.promise},_DEPRECATED_requestAddAllToProcess:function(){var o=t.defer();return n.post(e+"arrivals/",{addToProcess:"true"}).success(function(){o.resolve()}).error(function(e){o.reject(e)}),o.promise},fetchProcessTypesByClass:function(o){var i=t.defer();return n.get(e+"processtypes/",{params:{Class:o},cache:!0}).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise},fetchProcess:function(i){var s=t.defer();return n.get(e+"processes/"+i+"/").success(function(e){s.resolve(o([e])[0])}).error(function(e){s.reject(e)}),s.promise},fetchProcessesByProcessTypeIdAndRev:function(i,s,r){var a=t.defer();return n.get(e+"processes/",{params:{ProcessTypeId:i,Rev:s,IsComplete:r.IsComplete}}).success(function(e){a.resolve(o(e))}).error(function(e){
a.reject(e)}),a.promise},fetchProcessReference:function(o){var i=t.defer();return n.get(e+"processes/"+o+"/references/").success(function(e){angular.isArray(e)||(e=angular.fromJson(e)),i.resolve(e)}).error(function(e){i.reject(e)}),i.promise},updateProcessCheckStatus:function(o,i){var s=t.defer();return n.put(e+"processes/"+o+"/checkstatus",i).success(function(){s.resolve()}).error(function(e){s.reject(e)}),s.promise},updateProcessIsComplete:function(o,i){i===!0&&(i="true"),i===!1&&(i="false"),("true"!==i||"false"!==i||"waiting"!==i)&&console.warn("IsComplete Value error: "+i),i=angular.toJson(i);var s=t.defer();return n.put(e+"processes/"+o+"/iscomplete",i).success(function(){s.resolve()}).error(function(e){s.reject(e)}),s.promise},fetchProcessNodeTypes:function(o,i){var s=t.defer();return n.get(e+"processtypes/"+o+"/processnodetypes/",{params:{Rev:i}}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},updateProcessNodeAvailableFlag:function(o,i,s){var r=t.defer();return n.put(e+"processes/"+o+"/processnodes/"+i+"/availableflag",s).success(function(){r.resolve()}).error(function(e){r.reject(e)}),r.promise},updateProcessNodeCheckStatus:function(o,i,s){var r=t.defer();return n.put(e+"processes/"+o+"/processnodes/"+i+"/checkstatus",s).success(function(){r.resolve()}).error(function(e){r.reject(e)}),r.promise},updateProcessNodeConclusion:function(o,i,s){var r=t.defer();return n.put(e+"processes/"+o+"/processnodes/"+i+"/conclusion",s).success(function(){r.resolve()}).error(function(e){r.reject(e)}),r.promise}}}]).filter("FormStatusFilter",function(){return function(e){switch(e){case"0":return"未创建";case"1":return"待编辑";case"2":return"正在编辑";case"3":return"确认可提交";case"4":return"已提交";case void 0:return"未创建";default:return"读取出错"}}}).filter("TrueFalseShiFouFilter",function(){return function(e){return"true"===e?"是":"false"===e?"否":e===!0?"是":"否"}}).filter("ProcessNodeStatusFilter",function(){return function(e,t,n,o){if(n=+n,o=+o,o||(o=0),n||(n=0),t){if(angular.isUndefined(n))return"可用";switch(n=parseInt(n)){case 0:return"可用";case 1:return"可用";case 2:return"编辑中";case 3:return"编辑中";case 4:switch(o){case 0:return"待审核";case 1:return"已完成";case 2:return"审核不通过"}return"待审核"}return t+n+o}return"不可用"}}).filter("ProcessIsCompleteFilter",function(){return function(e){switch(e=angular.lowercase(e)){case"true":return"是";case"false":return"否";case"waiting":return"等待最终审核";default:console.warn("IsComplete value error: "+e)}}}).filter("ProcessNodeAvailableFlagFilter",function(){return function(e){switch(e){case"default":return"自动开启";case"true":return"手动开启";case"false":return"手动禁用"}return e}}),angular.module("RMI.ControlServices",[]).factory("ControlDesignSvc",["$http","$rootScope","$timeout","$q","SERVER_URL","KVStoreSvc",function(e,t,n,o,i,s){var r="Form.Source",a={general:{process:{Id:"X01",Name:"",Rev:0,Class:"辅料",CompleteCondition:"PN01.Status=4",Reference:'[{"Id":"arrival","Name":"shbg","Order":1,"Visible":true,"Components":[{"Order":1,"Visible":true,"Type":"table","Query":"select * from 123132","Data":[{"a":11,"b":22}],"Relation":{"a":"yi","b":"er"}},{"Order":2,"Visible":true,"Type":"map","Data":{"a":11,"b":22},"Relation":{"a":"yi","b":"er"}},{"Order":3,"Visible":true,"Type":"html","Data":"<div>1</div>"}]}]'},form:{OptionalTags:["Error.A","Error.B","Error.C"]},map:{Type:"map",Style:"flex",Show:"true",QuickInitial:"(function(ref,util){var data={}; return data;})"},table:{Type:"table",Show:"true",QuickInitial:"(function(ref,util){var data=[]; return data;})"}},item:{process:{Id:"",Order:null,Name:"",ProcessTypeId:"",Rev:"",Description:"",AvailableCondition:"1",FormConfig:[]},form:{Order:null,Type:"map",Style:"flex",Show:"true",Config:"",DatabaseTableName:""},map:{Order:null,Name:"",LeftDescription:"",RightDescription:"",AttributeName:"",Row:"",Group:"",Width:"",Type:"text",Sources:[],Options:[],min:null,max:null,ngMinlength:null,ngMaxlength:null,ngPattern:null,ngTrim:!0,required:!0,disabled:!1,ngRequired:!0,ngDisabled:!1,ngChange:""},table:{Order:null,Name:"",AttributeName:"",Row:"",Group:"",Width:"",Type:"text",Sources:[],Options:[],min:null,max:null,ngMinlength:null,ngMaxlength:null,ngPattern:null,ngTrim:!0,required:!0,disabled:!1,ngRequired:!0,ngDisabled:!1,ngChange:""}}},c={table:{order:null,active:!1,content:{general:a.general.table,item:a.item.table,items:[]}},map:{order:"",active:!1,content:{general:a.general.map,item:a.item.map,items:[]}},form:{order:null,active:!1,content:{general:a.general.form,item:a.item.form,items:[]}},process:{order:null,active:!1,content:{general:a.general.process,item:a.item.process,items:[]}}};return{getPresetConfig:function(){return a},getCacheConfig:function(e){return c[e]},getCacheItemConfigByChildConfig:function(e){return{map:function(e){var t=e.content.general;return t.Config=e.content.items,t},table:function(e){var t=e.content.general;return t.Config=e.content.items,t},form:function(e){var t={FormConfig:{}};return t.FormConfig=e.content.general,t.FormConfig.Components=e.content.items,t}}[e](c[e])},saveItemCacheConfig:function(e,t){t?c[e].content.item=t:0},saveCacheConfig:function(e,t,n,o){c[e].content.items=t,n?c[e].content.general=n:0,o?c[e].order=o:0},saveCacheConfigByFatherConfig:function(e,t,n){var o={map:function(e){return{general:function(){var t=angular.copy(e);return delete t.Config,t}(),items:function(){return e.Config}()}},table:function(e){return{general:function(){var t=angular.copy(e);return delete t.Config,t}(),items:e.Config}},form:function(e){return{general:function(){var t=angular.copy(e.FormConfig);return delete t.Components,t}(),items:e.FormConfig.Components}},process:function(e){return{items:e}}},i=o[t](e);this.saveCacheConfig(t,i.items,i.general,n)},fetchProcessTypes:function(){var t=o.defer();return e.get(i+"processtypes/").success(function(e){t.resolve(e)}).error(function(e){t.reject(e)}),t.promise},fetchProcessType:function(t){var n=o.defer();return e.get(i+"processtypes/"+t+"/",{params:{Rev:0}}).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},fetchProcessNodeTypes:function(t,n){var s=o.defer();return e.get(i+"processtypes/"+t+"/processnodetypes/",{params:{Rev:n}}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},createProcessType:function(t){var n=o.defer();return e.post(i+"processtypes/"+t.Id+"/",t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},updateProcessType:function(t,n){var s=o.defer();return e.put(i+"processtypes/"+t+"/",n).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise},createProcessNodeType:function(t){var n=o.defer();return e.post(i+"processtypes/"+t.ProcessTypeId+"/processnodetypes/"+t.Id+"/",t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},createProcessNodeTypes:function(t){var n=o.defer();return e.post(i+"processtypes/"+t[0].ProcessTypeId+"/processnodetypes/",t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},updateProcessNodeTypes:function(e,t){return this.createProcessNodeTypes(t)},fetchSubclasses:function(){var t=o.defer();return e.get(i+"processtypes/subclasses/").success(function(e){t.resolve(e)}).error(function(e){t.reject(e)}),t.promise},createSubclass:function(t){var n=o.defer();return e.post(i+"processtypes/subclasses/",t).success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},deleteSubclass:function(t){var n=o.defer();return e["delete"](i+"processtypes/subclasses/"+t+"/").success(function(e){n.resolve(e)}).error(function(e){n.reject(e)}),n.promise},createSourceToKVStore:function(e){var t=o.defer();return s.read(r).then(function(n){angular.forEach(n,function(e){e.Name===n.Name&&t.reject("Sources Name Existed.")}),s.update(r,n.concat([e])).then(function(e){t.resolve(e)},function(e){t.reject(e)})},function(e){t.reject(e)}),t.promise},deleteSourceFromKVStore:function(e){var t=o.defer();return s.read(r).then(function(n){angular.forEach(n,function(t,o){t.Name===e&&n.splice(o,1)}),s.update(r,n).then(function(e){t.resolve(e)},function(e){t.reject(e)})},function(e){t.reject(e)}),t.promise},readSourcesFromKVStore:function(){var e=o.defer();return s.read(r).then(function(t){e.resolve(t)},function(t){e.reject(t)}),e.promise}}}]).factory("ControlFeedbackSvc",["$http","$q","SERVER_URL",function(e,t,n){return{createFeedback:function(o){var i=t.defer();return e.post(n+"feedback/",o).success(function(e){i.resolve(e)}).error(function(e){i.reject(e)}),i.promise}}}]).factory("ControlOperationSvc",["$http","$q","SERVER_URL",function(e,t,n){return{fetchOperations:function(o,i){i||(i=1e3),o="User";var s=t.defer();return e.get(n+"users/"+o+"/operations/",{params:{top:i}}).success(function(e){s.resolve(e)}).error(function(e){s.reject(e)}),s.promise}}}]).factory("ControlUserSvc",["$http","$q","SERVER_URL",function(e,t,n){return{fetchUsers:function(){var o=t.defer();return e.get(n+"users/").success(function(e){o.resolve(e)}).error(function(e){o.reject(e)}),o.promise}}}]).filter("FormProcessChineseFilter",function(){return function(e){return"form"===e||"Form"===e?"表单":"process"===e||"Process"===e?"表单":void 0}}),angular.module("RMI.HomeServices",[]).factory("LoginSvc",["$q","$http","SERVER_URL","cmLoginSvc","AccountSvc","$interval","$timeout",function(e,t,n,o,i,s,r){var a=!1,c=function(){a||o.show()};return r(function(){c()}),s(function(){c()},3e5),{isLoggedIn:function(){return a},login:function(o,s){var r=e.defer();return t.post(n+"users/"+o+"/login/",{Id:o,Password:s}).success(function(e){a=!0,i.setCurrentUser(e),r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},logout:function(){var o=i.currentUser().Id,s=e.defer();return t.post(n+"users/"+o+"/logout/").success(function(){a=!1,s.resolve(),r(function(){c()},1e3)}).error(function(){s.reject()}),s.promise},getSavedUsers:function(){var e=angular.fromJson(localStorage.getItem("Account.SavedUsers"));return angular.isArray(e)||(e=[]),e},setSavedUsers:function(e){angular.isArray(e)&&localStorage.setItem("Account.SavedUsers",angular.toJson(e))}}}]).factory("AccountSvc",["$state","$rootScope",function(e,t){var n={Username:"未登录",Id:"?",Department:"?",Job:"?"},o=angular.copy(n),i=function(){return[]},s=function(e){var t={"home.control.designProcess":"Permission.UI.Control.EditProcess","home.control.designEditProcess":"Permission.UI.Control.EditProcess","home.control.designEditForm":"Permission.UI.Control.EditProcess","home.control.designEditTable":"Permission.UI.Control.EditProcess","home.control.designEditMap":"Permission.UI.Control.EditProcess","home.control.designSource":"Permission.UI.Control.EditProcess"},n=i(),o=function(e,t){if(angular.isArray(e)){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1}return console.error("Param set not an array."),!1},s=!0;return angular.forEach(t,function(t,i){e.name===i&&(s=o(n,t))}),s};t.$on("$stateChangeStart",function(e,t,n){s(t,n)||(alert("您没有权限查看此页面！\n如有疑问，请于系统管理->问题反馈中提交您的反馈"),e.preventDefault())});var r=function(){return{"UserSetting.UI.Process.List.DefaultProcessType":{"收货":{Enable:!1,ProcessTypeId:"AR01",Rev:0},"主料":{Enable:!1,ProcessTypeId:"R01",Rev:0},"辅料":{Enable:!1,ProcessTypeId:"R02",Rev:0}}}}();return{currentUser:function(){return o},getCurrentUser:function(){return o},setCurrentUser:function(e){o=e},getUserSetting:function(e){return r[e]?r[e]:void 0},setUserSetting:function(e,t){r[e]=t}}}]),angular.module("RMI").run(["$templateCache",function(e){e.put("app/interaction/control/base.html",'<cm-side-menu-box><cm-side-menu><section class="category"><h4>流程表单设计</h4><ul><li ui-sref-active="active" ui-sref="home.control.designClassification">检验任务分配规则</li></ul><h4>使用管理</h4><ul><li ui-sref-active="active" ui-sref="home.control.user">用户管理</li><li ui-sref-active="active" ui-sref="home.control.operationRecord({top:500})">操作记录</li></ul><h4>问题反馈</h4><ul><li ui-sref-active="active" ui-sref="home.control.feedbackNew">提交新问题</li></ul></section></cm-side-menu><div ui-view=""></div></cm-side-menu-box>'),e.put("app/interaction/dashboard/index.html",'<style>\n  .home-container{\n    position: fixed;\n    /*border-top: 1px dashed #DEDEDE;*/\n    border-top: 2px solid #dddddd;\n/*    top: 28px;right: 28px;\n    bottom: 28px;left: 28px;\n    border: 1px solid rgba(0, 90, 161, 0.4);\n    box-shadow: 0 0 15px rgba(102, 175, 233, 0.4);*/\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n  }\n  .content-container{\n    position: absolute;\n    /*top: 45px;*/\n    top: 0;\n    right: 0;\n    bottom: 0;\n    left: 0;\n\n  }\n  .navbar{\n    position: absolute;\n    top: 0;\n    right: 0;\n    left: 0;\n  }\n  .main{\n    /*padding-top: 52px;*/\n  }\n</style><div class="home-container"><cm-login></cm-login><cm-loading></cm-loading><cm-nav-menu></cm-nav-menu><div class="content-container"><div class="main" ui-view="main"></div></div></div>'),e.put("app/interaction/dashboard/main.html",'<cm-side-menu-box><cm-side-menu><section class="category"><h4>登录信息</h4><ul><li>姓名：{{currentUser.Name}}</li><li>工号：{{currentUser.Id}}</li><li>部门：{{currentUser.Department}}</li><li>职务：{{currentUser.Job}}</li></ul></section><section class="category"><br><h4>快捷信息</h4><ul><li ng-click="$parent.role=\'luruyuan\'">仓库收货</li><li ng-click="$parent.role=\'zhuliaojianyanyuan\'">主料检验</li><li ng-click="$parent.role=\'fuliaojianyanyuan\'">辅料检验</li></ul></section><section class="category" ng-if="false"><h4>消息通知</h4><ul><li>新数据提示 12</li></ul></section></cm-side-menu><cm-side-menu-content class="tmp-home-main"><cm-side-menu-content-header><section class="title"><h2 title="{{version}}">美山子原材料检验系统</h2></section><section class="toolbar"><div class="button" ui-sref="home.control.feedbackNew">意见反馈</div><cm-person></cm-person></section></cm-side-menu-content-header><article><header><div class="jumbotron"><h3><span class="ion-arrow-right-b" style="padding-right: 16px"></span>欢迎回来，{{currentUser.Name}} !</h3><p>现在是{{currentTime | date:\' yyyy年MM月dd日 HH:mm:ss \'}}，下面是与您相关的一些信息。</p><form class="form-inline" style="margin: 4px auto 14px auto" ng-submit="funcQuickGoProcess(quickGoProcessASN)"><div class="form-group"><label class="sr-only"></label><div class="input-group"><div class="input-group-addon">流程编号</div><input type="text" class="form-control" ng-model="quickGoProcessASN" autofocus=""></div></div><button type="submit" class="btn btn-primary">快速跳转</button></form></div></header><section ng-init="role=\'luruyuan\'" class="card-list"><div ng-show="role===\'luruyuan\'" class="row"><div class="col-sm-4"><div class="card card-block" ng-click="funcAddArrivalForm()"><h3 class="card-title">添加收货报告</h3><p class="card-text">点此添加新的收货报告记录</p></div></div><div class="col-sm-4"><div class="card card-block" ui-sref="home.process.formList({ \'Class\': \'收货\', \'ProcessTypeId\':\'ARRIVAL\', \'ProcessNodeTypeId\':undefined })"><h3 class="card-title">查看收货列表</h3><p class="card-text">浏览已经创建的收货报告</p></div></div><div class="col-sm-4" ui-sref="home.control.operationRecord({\'top\':500})"><div class="card card-block"><h3 class="card-title">查看操作记录</h3><p class="card-text">查阅您的最近的修改记录</p></div></div></div><div ng-show="role===\'zhuliaojianyanyuan\'" class="row"><div class="col-sm-4"><div class="card card-block" ui-sref="home.process.processList({ \'Class\': \'主料\', \'ProcessTypeId\':undefined, \'ProcessNodeTypeId\':undefined, \'Rev\':undefined })"><h3 class="card-title">查看主料检验队列</h3><p class="card-text">查看待检验材料并进行检验录入</p></div></div><div class="col-sm-4" ui-sref="home.control.operationRecord({\'top\':500})"><div class="card card-block"><h3 class="card-title">查看操作记录</h3><p class="card-text">查阅您的最近的修改记录</p></div></div></div><div ng-show="role===\'fuliaojianyanyuan\'" class="row"><div class="col-sm-4"><div class="card card-block" ui-sref="home.process.processList({ \'Class\': \'辅料\', \'ProcessTypeId\':undefined, \'ProcessNodeTypeId\':undefined, \'Rev\':undefined })"><h3 class="card-title">查看辅料检验队列</h3><p class="card-text">查看待检验材料并进行检验录入</p></div></div><div class="col-sm-4" ui-sref="home.control.operationRecord({\'top\':500})"><div class="card card-block"><h3 class="card-title">查看操作记录</h3><p class="card-text">查阅您的最近的修改记录</p></div></div></div></section><br></article></cm-side-menu-content></cm-side-menu-box>'),e.put("app/interaction/playground/main.html",'<cm-side-menu><cm-side-menu-content><<<<<<< HEAD<hr><div style="overflow-y: auto"><table class="table table-bordered"><thead></thead><tbody><tr><td rowspan="6">试样描述</td><td>申请部门</td><td><cm-select options="[dep1,dep2,dep3]" model="fromData.shenqingbumen"></cm-select></td><td>申请日期</td><td><cm-input type="date" model="fromData.shenqingriqi"></cm-input></td></tr><tr><td>样品</td><td>1</td><td>2</td><td>3</td></tr><tr><td>款号</td><td><cm-input type="text" model="fromData.kuanhao1"></cm-input></td><td><cm-input type="text" model="fromData.kuanhao2"></cm-input></td><td><cm-input type="text" model="fromData.kuanhao3"></cm-input></td></tr><tr><td>颜色/数量</td><td><div class="ia-div-flex"><cm-input class="ia-table-inline" style="" model="fromData.yanse1"></cm-input><span style="margin-left: 5px;margin-right: 5px;font-size:14px">/</span><cm-input model="fromData.shuliang1" type="number" class="ia-table-inline"></cm-input></div></td><td class=""><div class="ia-div-flex"><cm-input class="ia-table-inline" style="" model="fromData.yanse2"></cm-input><span style="margin-left: 5px;margin-right: 5px;font-size:14px">/</span><cm-input model="fromData.shuliang2" type="number" class="ia-table-inline"></cm-input></div></td><td class=""><div class="ia-div-flex"><cm-input class="ia-table-inline" style="" model="fromData.yanse3"></cm-input><span style="margin-left: 5px;margin-right: 5px;font-size:14px">/</span><cm-input model="fromData.shuliang3" type="number" class="ia-table-inline"></cm-input></div></td></tr><tr><td colspan="4"><span>洗涤目的：</span> <textarea></textarea></td></tr><tr><td colspan="4">洗前描述： <textarea></textarea></td></tr><tr><td colspan="5"><center><strong>洗涤方法选择</strong></center></td></tr><tr><td>程 序</td><td>温 度（℃）</td><td>转 数 （转/分钟）</td><td>烘 干</td><td>洗涤次数</td></tr><tr><td><cm-checkbox model="fromData.mianmazhiwu" options="[\'棉麻织物\']"></cm-checkbox></td><td><cm-checkbox model="fromData.mianmazhiwu_wendu" options="[\'冷水\',\'40\',\'60\',\'95\']"></cm-checkbox></td><td><cm-checkbox model="fromData.mianmazhiwu_zhuanshu" options="[\'400\',\'600\',\'800\',\'1000\',\'1200\']"></cm-checkbox></td><td><cm-checkbox model="fromData.mianmazhiwu_honggan" options="[\'标准\',\'强力\',\'低温\',\'轻微\']"></cm-checkbox></td><td><div class="ia-div-flex"><cm-input class="ia-table-inline" style="width: 30px" model="fromData.mianmazhiwu_cishu"></cm-input>次</div></td></tr><tr></tr><tr><td><cm-checkbox model="fromData.jingxizhiwu" options="[\'精细织物\']"></cm-checkbox></td><td><cm-checkbox model="fromData.jingxizhiwu_wendu" options="[\'冷水\',\'30\',\'40\']"></cm-checkbox></td><td><cm-checkbox model="fromData.jingxizhiwu_zhuanshu" options="[\'400\',\'600\',\'800\']"></cm-checkbox></td><td><cm-checkbox model="fromData.jingxizhiwu_honggan" options="[\'标准\',\'强力\',\'低温\',\'轻微\']"></cm-checkbox></td><td><div class="ia-div-flex"><cm-input class="ia-table-inline" style="width: 30px" model="fromData.jingxizhiwu_cishu"></cm-input>次</div></td></tr><tr><td><cm-checkbox model="fromData.renzaoxianwei" options="[\'人造纤维\']"></cm-checkbox></td><td><cm-checkbox model="fromData.renzaoxianwei_wendu" options="[\'冷水\',\'30\',\'40\']"></cm-checkbox></td><td><cm-checkbox model="fromData.renzaoxianwei_zhuanshu" options="[\'400\',\'600\',\'800\',\'1000\']"></cm-checkbox></td><td><cm-checkbox model="fromData.renzaoxianwei_honggan" options="[\'标准\',\'强力\',\'低温\',\'轻微\']"></cm-checkbox></td><td><div class="ia-div-flex"><cm-input class="ia-table-inline" style="width: 30px" model="fromData.renzaoxianwei_cishu"></cm-input>次</div></td></tr><tr><td><cm-checkbox model="fromData.kuaisuxi" options="[\'快速洗\']"></cm-checkbox></td><td><cm-checkbox model="fromData.kuaisuxi_wendu" options="[\'冷水\',\'30\',\'40\']"></cm-checkbox></td><td><cm-checkbox model="fromData.kuaisuxi_zhuanshu" options="[\'400\',\'600\',\'800\',\'1000\']"></cm-checkbox></td><td><cm-checkbox model="fromData.kuaisuxi_honggan" options="[\'标准\',\'强力\', \'低温\',\'轻微\']"></cm-checkbox></td><td><div class="ia-div-flex"><cm-input class="ia-table-inline" style="width: 30px" model="fromData.kuaisuxi_cishu"></cm-input>次</div></td></tr><tr><td rowspan="2">其他洗涤要求</td><td colspan="4"><cm-radio options="[\'加洗涤剂\',\'不加洗涤剂\']" model="fromData.qitaxidiyaoqiu_xuanxiang"></cm-radio></td></tr><tr><td colspan="4"><textarea></textarea></td></tr><tr><td colspan="5"><center><strong>水洗后情况描述</strong></center></td></tr><tr><td>1</td><td colspan="4"><textarea></textarea></td></tr><tr><td>2</td><td colspan="4"><textarea></textarea></td></tr><tr><td>3</td><td colspan="4"><textarea></textarea></td></tr><tr><td colspan="5">判定结果：<cm-radio options="[\'合格\',\'不合格\',\'开发测试，不作判定\']"></cm-radio></td></tr><tr><td colspan="5"><span style="color: dodgerblue;">备注：检测仅对来样负责</span></td></tr><tr><td colspan="2">测试员/日期：</td><td colspan="2">审核/日期：</td><td colspan="2">批准/日期：</td></tr></tbody></table></div>=======<section ng-init="input=\'1\';checkbox=\'1\';radio=\'1\';select=\'1\';"><cm-input type="text" model="input"></cm-input>{{input}}<cm-input type="password" model="input"></cm-input>{{input}}<cm-checkbox options="[100,200,300,400]" model="checkbox"></cm-checkbox>{{checkbox}}<cm-radio options="[100,200,300,400]" model="radio"></cm-radio>{{radio}}<cm-select options="[100,200,300,400]" model="select"></cm-select>{{select}}<cm-toggle model="toggle"></cm-toggle>{{toggle}}<cm-textarea model="textarea"></cm-textarea>{{textarea}}</section>>>>>>>> origin/devbycm</cm-side-menu-content></cm-side-menu>'),e.put("app/components/ui/cmLoading/template.html",'<div class="cmLoading"><div class="shade" ng-if="isShow"></div><div class="loading cm-animation-fade" ng-if="false"><div class="spinner spinner-lines"><svg viewbox="0 0 64 64"><g stroke-width="7" stroke-linecap="round"><line x1="10" x2="10" y2="48" y1="16"></line><animate attributename="y1" dur="750ms" values="16;18;28;18;16;16" repeatcount="indefinite"></animate><animate attributename="y2" dur="750ms" values="48;46;36;44;48;48" repeatcount="indefinite"></animate><animate attributename="stroke-opacity" dur="750ms" values="1;.4;.5;.8;1;1" repeatcount="indefinite"></animate><line x1="24" x2="24" y2="45.3897" y1="17.3052"></line><animate attributename="y1" dur="750ms" values="16;16;18;28;18;16" repeatcount="indefinite"></animate><animate attributename="y2" dur="750ms" values="48;48;46;36;44;48" repeatcount="indefinite"></animate><animate attributename="stroke-opacity" dur="750ms" values="1;1;.4;.5;.8;1" repeatcount="indefinite"></animate><line x1="38" x2="38" y2="38.7793" y1="24.5258"></line><animate attributename="y1" dur="750ms" values="18;16;16;18;28;18" repeatcount="indefinite"></animate><animate attributename="y2" dur="750ms" values="44;48;48;46;36;44" repeatcount="indefinite"></animate><animate attributename="stroke-opacity" dur="750ms" values=".8;1;1;.4;.5;.8" repeatcount="indefinite"></animate><line x1="52" x2="52" y2="42.5258" y1="21.4742"></line><animate attributename="y1" dur="750ms" values="28;18;16;16;18;28" repeatcount="indefinite"></animate><animate attributename="y2" dur="750ms" values="36;44;48;48;46;36" repeatcount="indefinite"></animate><animate attributename="stroke-opacity" dur="750ms" values=".5;.8;1;1;.4;.5" repeatcount="indefinite"></animate></g></svg></div></div><div class="pane cm-animation-fade" ng-if="isShow"><div class="content"><span ng-if="status===\'inProgress\'"></span> <span ng-if="status===\'success\'"></span> <span ng-if="status===\'error\'"></span> {{content}}</div></div></div>'),e.put("app/components/ui/cmLogin/template.html",'<div class="cmLogin"><div class="shade" ng-if="isShow" ng-click="funcTryToClose()"></div><div class="pane-a cm-animation-fade" ng-if="isShow"><header style="position: relative;"><div class="close-button ion-ios-close" ng-show="isLoggedIn" ng-click="funcTryToClose()"></div><br><br><div style="text-align: center"><h3 style="text-shadow:0 0 2px #DDDDDD">美山子原材料检验</h3></div></header><div class="content" ng-controller="cmLoginCtrl" ng-switch="uiWhichPanel"><section class="switchPanel" ng-switch-when="switch"><div class="avatar-group"><div class="avatar" ng-repeat="user in savedUsers" ng-mouseleave="uiCurrentHoverIndex=null" ng-mouseenter="uiCurrentHoverIndex=$index"><div class="remove ion-ios-close" ng-show="user.Username&&uiCurrentHoverIndex===$index" ng-click="funcRemoveUser($index)"></div><div ng-click="funcDisplayUserLogin(user)"><img ng-src="{{user.Avatar}}"><div class="name" ng-show="user.Username&&uiCurrentHoverIndex===$index">{{user.Username}}</div></div></div></div><br><div class="description" ng-show="savedUsers.length>0">请选择一个用户以登陆<span ng-show="savedUsers.length<4">，<a ng-click="funcDisplayNewUserLogin()">或添加一个</a></span></div><div class="description" ng-show="!savedUsers.length>0">还没有存储的用户<span ng-show="savedUsers.length<4">，<a ng-click="funcDisplayNewUserLogin()">点此添加一个</a></span></div></section><section class="loginPanel" ng-switch-when="login"><form ng-submit="funcLogin()"><div class="center"><div style="margin-right: 25px"><div class="avatar" ng-mouseenter="uiIsHover=true" ng-mouseleave="uiIsHover=false"><img ng-src="{{selectedUser.Avatar}}"><div class="name" ng-show="uiIsHover">{{selectedUser.Username}}</div></div></div><div class="login-form {{uiIsInputError?\'has-error\':\'\'}}"><div><label><input type="text" class="form-control above" ng-model="selectedUser.Id" ng-change="funcCancelInputErrorMark();funcUserIdChanged()" autofocus="" placeholder="工号" required="" ng-disabled="uiIsLoggingIn"></label></div><hr><div><label><input type="password" class="form-control below" ng-model="selectedUser.Password" ng-change="funcCancelInputErrorMark()" placeholder="密码" required="" ng-disabled="uiIsLoggingIn"></label></div><div class="options"><label><input type="checkbox" value="true" checked="checked" ng-model="selectedUser.AutoUpdateSavedUser" ng-disabled="uiIsLoggingIn"> <span>保存登录凭证</span></label> <label ng-show="savedUsers.length>0"><span ng-show="uiIsLoggingIn">其他用户</span> <a ng-show="!uiIsLoggingIn" ng-click="funcCancelInputErrorMark();funcDisplayUserSwitch()">其他用户</a></label></div></div></div><div class="form-group"><br><button type="submit" class="btn btn-primary login-button" ng-disabled="uiIsLoggingIn"><span ng-show="!uiIsLoggingIn">登录</span> <span ng-show="uiIsLoggingIn">正在登陆中...</span></button></div></form></section><section class="successPanel" ng-switch-when="success"><div class="success"><span class="ion-checkmark-round"></span>登陆成功！1秒后返回</div></section></div></div></div>'),e.put("app/components/ui/cmNavBar/template.html",'<div class="cmNavBar" ng-controller="cmNavBarCtrl"><div class="nav-part hide-style"><span class="icon button ion-android-arrow-back {{canGoBack?\'active\':\'\'}}" ng-click="goBack()"></span><div class="current" ng-click="toggleMenu()"><span class="icon {{menuItem.icon||\'ion-ios-photos-outline\'}}"></span> <span class="text">{{menuItem.title||"其他"}}</span> <span class="down"></span> <span class="down ion-ios-arrow-down"></span></div></div><div class="title-part" ng-if="false"><div><span class="title">{{title}}</span></div><div><span class="button active">{{$state.$current.name}}</span> <span class="button active" ng-if="">反馈</span></div></div></div>'),e.put("app/components/ui/cmNavMenu/template.html",'<div class="cmNavMenu"><div class="shade" ng-if="show" ng-click="close()"></div><div class="triangle cm-animation-fade" ng-if="show"></div><div class="navMenu cm-animation-fade" ng-if="show"><div class="content"><div class="block"><div class="item" ng-repeat="i in menuItems" ng-click="goAndClose(i.state,i.params)" ng-show="i.show"><div class="icon {{i.icon}}"></div><div class="label">{{i.label}}</div></div></div></div></div></div>'),e.put("app/components/ui/cmNotificationArea/template.html",'<div class="cmNotificationArea"><div class="button {{uiIsPanelShow?\'active\':\'\'}}" ng-click="uiIsPanelShow=!uiIsPanelShow"><div class="item"><span class="ion-android-person"></span>{{currentUser.Name}}</div></div><div class="panel" ng-show="uiIsPanelShow"><div class="option" ng-click="funcSwitchUser()">切换用户</div><div class="option" ng-click="funcLogout()">退出登录</div></div></div>'),e.put("app/components/ui/cmSideMenuBox/template.html",'<div ng-transclude=""></div>'),e.put("app/interaction/control/design/classification.html",'<cm-side-menu-content class="control"><cm-side-menu-content-header><section class="title">查看并修改原材料检验任务分配规则</section><section class="toolbar"></section></cm-side-menu-content-header><section class="block" ng-show="0"><h4>添加新的对应</h4><section class="map"><div class="row"><div class="item"><div class="name">物料名称</div><div class="input"><input type="text"></div></div><div class="item"><div class="name">对应流程类型</div><div class="input"><select name="" id=""></select></div></div></div></section><input class="btn btn-default" type="submit" id="submit" value="添加"></section><section class="block"><h4>当前分配规则</h4><br><table class="table table-hover table-bordered"><thead><tr><th>#</th><th>物料名称</th><th>流程类型</th><th>大类</th><th>操作</th></tr></thead><tbody><tr><td></td><td><label style="width: 100%;margin: 0;"><input style="border: 0;" type="text" ng-model="subclass.Subclass"></label></td><td><label style="width: 100%;margin: 0;"><select style="border: 0;" ng-model="subclass.ProcessTypeId" ng-options="ProcessType.Id as (ProcessType.Name+\' \'+ProcessType.Id) group by ProcessType.Class for ProcessType in OptionalProcessTypes track by ProcessType.Name"><option value="" ng-show="!subclass.ProcessTypeId">-- 请选择流程类型 --</option></select></label></td><td>-</td><td><a ng-click="funcSubmitSubclass(subclass)">添加</a></td></tr><tr ng-repeat="subclass in subclasses"><td>{{ $index+1 }}</td><td>{{subclass.Subclass}}</td><td>{{subclass.Name+\' \'+subclass.ProcessTypeId}}</td><td>{{subclass.Class}}</td><td><a ng-click="funcRemoveSubclass(subclass.Id)">删除</a></td></tr></tbody></table></section></cm-side-menu-content>'),e.put("app/interaction/control/design/process.html",'<cm-side-menu-content class="control"><cm-side-menu-content-header><section class="title">查看并修改流程信息</section><section class="toolbar"><div class="button">添加新的流程</div><div class="button" ui-sref="home.control.designEditProcess({\'isEditCache\':\'cache\'})">进入缓存流程编辑</div></section></cm-side-menu-content-header><section class="block" ng-if="false"><h4>编辑流程基本信息</h4><section class="map"><div class="row"><div class="item"><div class="name">Id</div><input class="value" type="text"></div><div class="item"><div class="name">分类</div><input class="value" type="text"></div><div class="item"><div class="name">名称</div><input class="value" type="text"></div><div class="item"></div></div><div class="row"><div class="item"><div class="name">描述</div><input type="text" class="value" style="width: 67%;"></div></div></section><input class="btn btn-default" type="submit" id="submit" value="添加"></section><section class="block"><h4>当前流程列表</h4><br><table class="table table-hover table-bordered"><thead><tr><th width="15%">Id</th><th width="15%">Rev</th><th width="15%">分类</th><th width="15%">名称</th><th width="40%">描述</th><th width="15%">操作</th></tr></thead><tbody><tr ng-repeat="processType in processTypes"><td>{{processType.Id}}</td><td>{{processType.Rev}}</td><td>{{processType.Class}}</td><td>{{processType.Name}}</td><td>{{processType.Description}}</td><td><span style="cursor: pointer" ng-click="funcEditProcess(processType.Id,processType.Rev)">编辑</span></td></tr></tbody></table></section></cm-side-menu-content>'),e.put("app/interaction/control/design/source.html",'<cm-side-menu-content class="form-table control"><cm-side-menu-content-header><section class="title"><h2>配置选项数据来源</h2></section><section class="toolbar"><div class="button {{uiIsAddPanelShow?\'active\':\'\'}}" ng-click="$parent.uiIsAddPanelShow=!$parent.uiIsAddPanelShow">添加新来源</div></section></cm-side-menu-content-header><section class="block" ng-show="uiIsAddPanelShow"><h4>新的选项数据来源</h4><form name="addNewCol" ng-submit="funcCreateSource()"><section class="map"><div class="row"><div class="item"><div class="name">来源描述</div><div><input type="text" class="value" ng-model="config.Description" placeholder="描述来源内容" required=""></div></div><div class="item"><div class="name">调用名</div><div><input type="text" class="value" ng-model="config.Name" placeholder="调用使用的名称，限字母" required=""></div></div><div class="item"></div></div><div class="row"><div class="item"><div class="name">类型</div><div><label title="字面量"><input type="radio" ng-model="config.Type" id="inlineRadio1" value="value">字面量</label> <label title="SQL查询"><input type="radio" ng-model="config.Type" id="inlineRadio2" value="sql" disabled="">SQL查询</label> <label title="关联关系"><input type="radio" ng-model="config.Type" id="inlineRadio3" value="relation" disabled="">关联关系</label></div></div></div><div class="row" ng-show="config.Type===\'value\'"><div class="item"><div class="name">可选值</div><input type="text" class="value" ng-model="config.Value" ng-list="" placeholder="使用 , 分开多个选项" style="width: 60%"></div></div></section><input class="btn btn-default" type="submit" id="submit" value="提交到服务器"></form></section><section class="block"><h4>存储的选项数据来源</h4><table class="table table-hover table-bordered table-condensed"><thead><tr><th width="5%">序号</th><th width="5%">修改</th><th width="15%">来源描述</th><th width="10%">调用名</th><th width="10%">类型</th><th width="55%">可选值</th></tr></thead><tbody><tr ng-repeat="config in configs"><td>{{$index+1}}</td><td ng-click="funcDeleteSource(config.Name)" style="cursor: pointer;">删除</td><td>{{config.Description}}</td><td>{{config.Name}}</td><td>{{config.Type}}</td><td>{{config.Value}}</td></tr><tr ng-show="!(configs.length>0)"><td colspan="6" style="height: 64px;text-align:center;line-height:64px;background-color: #F4F4F4;font-size: 15px">服务器上还没有选项数据来源</td></tr></tbody></table></section><section class="block"><pre>\n      {{configs}}\n    </pre></section></cm-side-menu-content>'),
e.put("app/interaction/control/feedback/new.html",'<cm-side-menu-content><cm-side-menu-content-header><section class="title"><h2>提交您的反馈</h2></section></cm-side-menu-content-header><section style="width: 67%;"><form ng-submit="funcSubmitNewFeedback(feedback)"><h5>主题</h5><input type="text" class="form-control" ng-model="feedback.Subject"><br><h5>反馈内容</h5><textarea rows="15" class="form-control" style="resize: none" ng-model="feedback.Content" required=""></textarea><br><button class="btn btn-default">提交</button></form></section></cm-side-menu-content>'),e.put("app/interaction/control/operation/record.html",'<cm-side-menu-content><cm-side-menu-content-header><section class="title"><h2>查看操作记录</h2></section></cm-side-menu-content-header><table class="table"><thead><tr><th>时间</th><th>对象</th><th>描述</th><th>操作</th><th>用户名</th><th>IP</th></tr></thead><tbody><tr ng-repeat="operation in operations"><td>{{operation.Time | date:\'MM月dd日&nbsp;&nbsp;HH:mm \'}}</td><td><a ng-click="funcGo(operation.Type,operation.Id)">{{operation.Type | FormProcessChineseFilter}}&nbsp;{{operation.Id}}</a></td><td>{{operation.Description}}</td><td>{{operation.Operation}}</td><td>{{operation.Username}}</td><td>{{operation.IP}}</td></tr></tbody></table></cm-side-menu-content>'),e.put("app/interaction/control/user/all.html",'<cm-side-menu-content><cm-side-menu-content-header><section class="title"><h2>用户管理</h2></section><section class="toolbar"><div class="button" ng-click="funcOpenUserModifyModal(emptyUser)">添加新用户</div></section></cm-side-menu-content-header><section><table class="table table-content-vertical-middle"><thead><tr><th>工号</th><th>姓名</th><th>部门</th><th>职务</th><th>权限</th><th>操作</th></tr></thead><tbody><tr ng-repeat="user in users" style="width: 100%;"><td style="min-width: 50px;">{{user.Id}}</td><td style="min-width: 150px;"><img ng-src="{{user.Avatar}}" style="height: 24px;width: 24px;margin:0 10px 0 0"> {{user.Username}}</td><td style="min-width: 100px;">{{user.Department}}</td><td style="min-width: 100px;">{{user.Job}}</td><td style="word-break: break-all">{{user.Permission}}</td><td style="min-width: 100px;"><a ng-click="funcOpenUserModifyModal(user)">修改用户信息</a></td></tr></tbody></table></section></cm-side-menu-content>'),e.put("app/interaction/control/user/modify.html",'<div class="modal-header"><div class="modal-title">添加或修改用户</div></div><div class="modal-body"><section class="form"><form ng-submit="vm.onSubmit()" name="vm.form" novalidate=""><formly-form model="vm.model" fields="vm.fields" options="vm.options" form="vm.form"><div class="button-row"><button type="submit" class="btn btn-primary submit-button pull-right" ng-disabled="vm.form.$invalid">提交</button></div></formly-form></form></section></div>'),e.put("app/interaction/process/detail/base.html",'<cm-side-menu-box><cm-side-menu style="width: 60px;box-sizing: border-box;font-size: 22px;"><div style="height: 67%;display: flex;flex-direction:column;justify-content: center;"><div ng-show="form.Status===\'2\'"><ul ng-if="false"><li class="{{uiIsReferencePanelShow?\'active\':\'\'}}" ng-click="funcSwitchReferencePanel()" style="padding: 0;"><div class="ion-ios-bookmarks" style="text-align: center;height: 100%;" title="参考"></div></li></ul><ul><li ng-click="funcSideSaveForm()" style="padding: 0;"><div class="ion-folder" style="text-align: center;height: 100%;" title="暂存"></div></li></ul><ul><li class="{{option.all.isEditable?\'\':\'active\'}}" ng-click="funcSideViewForm()" style="padding: 0;"><div class="ion-eye" style="text-align: center;height: 100%;" title="查看"></div></li><li class="{{option.all.isEditable?\'active\':\'\'}}" ng-click="funcSideEditForm()" style="padding: 0;"><div class="ion-edit" style="text-align: center;height: 100%;" title="编辑"></div></li></ul><ul></ul></div><div ng-show="form.Status!==\'2\'"><ul><li class="disabled" style="padding: 0;"><div class="ion-folder" style="text-align: center;height: 100%;" data-trigger="hover" data-type="info" data-title="保存" bs-tooltip=""></div></li></ul><ul><li class="disabled {{option.all.isEditable?\'\':\'active\'}}" style="padding: 0;"><div class="ion-eye" style="text-align: center;height: 100%;" data-trigger="hover" data-type="info" data-title="查看" bs-tooltip=""></div></li><li class="disabled {{option.all.isEditable?\'active\':\'\'}}" style="padding: 0;"><div class="ion-edit" style="text-align: center;height: 100%;" data-trigger="hover" data-type="info" data-title="编辑" bs-tooltip=""></div></li></ul><ul></ul></div></div></cm-side-menu><ng-include ng-if="state.current.name===\'home.process.detailForm\'" src="\'app/interaction/process/detail/form.html\'"></ng-include></cm-side-menu-box>'),e.put("app/interaction/process/detail/form.html",'<cm-side-menu-content style="left: 60px;"><cm-side-menu-content-header><section class="form-infomation"><div class="basic">{{formInfo.Status | FormStatusFilter}}：{{formInfo.Id}}</div><div class="edit" title="创建：由 {{formInfo.CreateUserName}} 在 {{formInfo.CreateTime | date:\'MM/dd hh:mm:ss\'}}">最后修改：由 {{formInfo.LastModifiedUserName}} 在 {{formInfo.LastModifiedTime | date:\'MM/dd hh:mm:ss\'}}</div></section><section class="toolbar"><div class="button" ng-show="formInfo.Status===\'2\'&&!uiIsAutoSaveFormData" ng-click="funcSaveToServer()">暂存</div><div class="button disabled" ng-show="formInfo.Status===\'2\'&&uiIsAutoSaveFormData">自动暂存中...</div><div class="button" ng-show="formInfo.Status===\'2\'" ng-click="funcSubmitForm()">提交表单</div></section></cm-side-menu-content-header><section class="block" ng-show="uiIsReferencePanelShow&&references.length"><div class="reference-switch" style="display: flex;"><div ng-repeat="ref in references" class="switcher {{$index===uiCurrentActiveReferenceIndex?\'active\':\'\'}}" ng-click="funcSwitchReference($index)" title="{{ref.Id}}">{{ref.Name}}</div></div><hr style="margin: 6px 0 12px 0;"><ng-include src="\'app/interaction/process/detail/reference.html\'"></ng-include></section><section ng-show="stateParams.ArrivalSerialNumber===\'ARRIVAL\'&&formInfo.Status===\'4\'" style="padding: 12px;margin-bottom:12px;border: 1px solid #eaf2e0;border-radius: 2px;background-color: #f6f9f0;color: darkgreen;"><div style="font-size: 16px;margin-bottom: 2px">该收货报告有问题？<a ng-click="funcRedoForm(formInfo.Id)">点击这里</a> <span style="opacity: 0.9;">重新编辑该表单。</span></div><div style="opacity: 0.6;font-size: 14px">提交后将重新生成检验任务，前后没有变化的检验任务不受到影响。</div><div style="opacity: 0.6;font-size: 14px">该报告生成的检验任务链接： <a ng-repeat="asn in formInfo.Parameter.processes" ui-sref="home.process.detailInfo({ArrivalSerialNumber:asn})">{{asn}}</a></div></section><div><section style="padding: 12px;border: 1px solid #f2f2f2;border-radius: 2px;background-color: #f9f9f9"><div ng-if="formConfig.fields"><formly-form model="formData" fields="formConfig.fields" form="formConfig.form" options="formConfig.options"></formly-form></div><div ng-if="formConfig.template"><cm-template-load template="{{formConfig.template}}" model="formData"></cm-template-load></div></section><section><br><pre>{{formData}}</pre></section></div></cm-side-menu-content>'),e.put("app/interaction/process/detail/info.html",'<cm-side-menu-box><cm-side-menu style="width: 60px;"></cm-side-menu><cm-side-menu-content style="left: 60px;" class="rmiProcessDetailInfo"><cm-side-menu-content-header><section class="title" style="display: flex"><div style="margin: 5px 10px 0 0;"><div class="cm-table-indicator-dot" style="background-color: {{\'#\'+process.ArrivalSerialNumber}}"></div></div><h2>{{\'检验任务： \'+process.TypeName+\' ，由 \'}}<a style="cursor: pointer;" ng-click="funcViewSourceForm(process.SourceFormId)">{{\'收获报告#\'+process.SourceFormId}}</a>{{\'生成\'}}</h2></section><section class="toolbar"><div class="button">打印该检验任务</div><div class="button">打印条形码</div></section></cm-side-menu-content-header><section class="info"><div class="info-part"><h4>基本信息</h4><div class="info-container"><div class="info-col"><div class="info-kv"><div class="key">物料类型</div><div class="value">{{process.TypeClass}}-{{process.TypeName}}-{{process.Parameter.wuliaomingcheng}}</div></div><div class="info-kv"><div class="key">供应商</div><div class="value">{{process.Parameter.gongyingshang}}</div></div><div class="info-kv"><div class="key">货号</div><div class="value">{{process.Parameter.huohao}}</div></div><div class="info-kv"><div class="key">颜色</div><div class="value">{{process.Parameter.yanse}}</div></div></div><div class="info-col"><div class="info-kv"><div class="key">开始时间</div><div class="value">{{process.StartTime | date:\'yyyy年M月d日&nbsp;&nbsp;HH:mm\'}}</div></div><div class="info-kv"><div class="key">是否完成</div><div class="value" title="{{process.IsComplete}}">{{process.IsComplete|ProcessIsCompleteFilter}}<a ng-show="process.IsComplete===true||process.IsComplete===\'true\'" ng-click="funcRedoComplete(process.ArrivalSerialNumber)" style="margin-left: 8px">撤销完成状态</a></div></div><div class="info-kv" ng-show="process.IsComplete===\'false\'||process.IsComplete===\'False\'" style="margin-top: 14px;"><div class="value"><button class="btn btn-default" ng-click="funcMarkProcessWaiting(process.ArrivalSerialNumber)">标记等待确认完成</button></div></div><div class="info-kv" ng-show="process.IsComplete===\'waiting\'" style="margin-top: 14px;"><div class="value"><button class="btn btn-default" ng-click="funcMarkProcessComplete(process.ArrivalSerialNumber)">标记检验完成</button></div></div><div class="info-kv" ng-show="process.IsComplete===\'true\'"><div class="key">完成时间</div><div class="value">{{process.CompleteTime | date:\'yyyy年M月d日&nbsp;&nbsp;HH:mm\'}}</div></div><div class="info-kv" ng-show="process.IsComplete===\'true\'"><div class="key">流程时间</div><div class="value" title="历时{{((+process.CompleteTime)-(+process.StartTime))/(24*60*60*1000)|number:1}}天">{{((+process.CompleteTime)-(+process.StartTime))/(60*60*1000)|number:1}}&nbsp;小时</div></div></div></div></div><div class="info-part"><h4>流水条形码</h4><div class="info-col"><div class="info-kv"><div class="value"><cm-barcode value="process.ArrivalSerialNumber"></cm-barcode></div></div></div></div></section><section><ul class="process-node-list"><li class="process-node" ng-repeat="Node in process.Nodes | orderBy:Node.Order"><div class="process-node-container"><header class="header" ng-init="Node.uiCurrentStageTabCode=funcGetCurrentStageTabCode(Node.Available,Node.Form.Status,Node.CheckStatus); Node.uiActiveTabCode=Node.uiCurrentStageTabCode; Node.uiIsTabAvailable =[]; Node.uiIsTabAvailable[0]=true; Node.uiIsTabAvailable[1]=Node.Available&&(Node.uiCurrentStageTabCode!==0); Node.uiIsTabAvailable[2]=Node.Available&&(Node.uiCurrentStageTabCode===2||Node.uiCurrentStageTabCode===3); Node.uiIsTabAvailable[3]=Node.Available&&(Node.uiCurrentStageTabCode===3);"><h4>{{Node.Name}} · {{1|ProcessNodeStatusFilter:Node.Available:Node.Form.Status:Node.CheckStatus}}</h4><div class="tabs"><div class="tab {{(Node.uiIsTabAvailable[tab.code])?\'\':\'disabled\'}}" ng-repeat="tab in [{\'name\':\'启用\',\'code\':0},{\'name\':\'检验\',\'code\':1},{\'name\':\'审核\',\'code\':2},{\'name\':\'完成\',\'code\':3}]" ng-click="(Node.uiIsTabAvailable[tab.code])&&(Node.uiActiveTabCode=tab.code)">{{tab.name}}<div ng-if="tab.code===Node.uiActiveTabCode" class="tri ion-arrow-up-b"></div></div></div><div ng-show="Node.Available"><div ng-show="Node.Form.Status===undefined"></div><div ng-show="Node.Form.Status!==undefined"><div class="quick-edit-form" ng-show="Node.Form.Status===null||Node.Form.Status===2||Node.Form.Status===\'2\'" ng-click="funcEditForm(process.ArrivalSerialNumber,Node.Form.Id)">快捷编辑</div><div class="quick-view-form" ng-hide="Node.Form.Status===null||Node.Form.Status===2||Node.Form.Status===\'2\'" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">表单查看</div></div></div></header><div class="content" ng-switch="Node.uiActiveTabCode"><div ng-switch-when="0"><div ng-switch="Node.Available"><div ng-switch-when="true"><h5>检验中 <span class="description">当前项状态</span></h5><p>启用方式：{{Node.AvailableFlag |ProcessNodeAvailableFlagFilter}}</p><button ng-click="funcUpdateProcessNodeAvailableFlag(process.ArrivalSerialNumber,Node.Id,\'default\')" class="btn btn-default">恢复默认</button> <button ng-click="funcUpdateProcessNodeAvailableFlag(process.ArrivalSerialNumber,Node.Id,\'true\')" class="btn btn-default">手动启用</button> <button ng-click="funcUpdateProcessNodeAvailableFlag(process.ArrivalSerialNumber,Node.Id,\'false\')" class="btn btn-default">手动禁止</button></div><div ng-switch-when="false"><p class="message">该项当前不可用<br>您可以选择 <a ng-click="funcUpdateProcessNodeAvailableFlag(process.ArrivalSerialNumber,Node.Id,\'true\')">手动启用</a></p></div><div ng-switch-default="">PAGE DISPLAY ERROR.</div></div></div><div ng-switch-when="1"><div ng-switch="Node.Form.Status"><section ng-switch-when="undefined"><h5>未创建 <span class="description">编辑状态</span></h5><p><br></p><button class="btn btn-block btn-default" ng-click="funcShortcutCreateFormAndRequestEditFormAndEditForm(process.ArrivalSerialNumber,process.TypeId,process.Rev,Node.Id)">创建并编辑</button></section><section ng-switch-when="0"><h5>未创建 <span class="description">编辑状态</span></h5><p>还未创建该检验项的报告</p><button class="btn btn-block btn-default" ng-click="funcShortcutCreateFormAndRequestEditFormAndEditForm(process.ArrivalSerialNumber,process.TypeId,process.Rev,Node.Id)">创建并编辑</button></section><section ng-switch-when="2"><h5>编辑中 <span class="description">编辑状态</span></h5><p></p><div style="line-height: 22px;color: #666;"><div>创建：{{Node.Form.CreateUserName}} {{Node.Form.CreateTime | date:\'yyyy年MM月dd日 hh:mm\'}}</div><div>最后编辑： {{Node.Form.LastModifiedUserName}}{{Node.Form.LastModifiedTime | date:\'yyyy年MM月dd日 hh:mm\'}}</div></div><p></p><button class="btn btn-block btn-default" ng-click="funcShortcutRequestEditFormAndEditForm(process.ArrivalSerialNumber,Node.Form.Id)">编辑</button> <button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcShortcutConfirmFormAndSubmitForm(Node.Form.Id)">提交</button><br><div><h5>检验结论<span class="description"></span></h5><label><input type="radio" ng-model="Node.Conclusion" value="空">空</label> <label><input type="radio" ng-model="Node.Conclusion" value="合格">合格</label> <label><input type="radio" ng-model="Node.Conclusion" value="不合格">不合格</label> {{Node.Conclusion}} <button class="btn btn-block btn-default" ng-click="funcUpdateProcessNodeConclusion(process.ArrivalSerialNumber,Node.Id,Node.Conclusion)">提交修改</button></div></section><section ng-switch-when="4"><h5>已提交 <span class="description">编辑状态</span></h5><p>检验报告已提交，等待审核</p><div style="line-height: 22px;color: #666;"><div>创建：{{Node.Form.CreateUserName}} {{Node.Form.CreateTime | date:\'yyyy年MM月dd日 hh:mm\'}}</div><div>最后编辑： {{Node.Form.LastModifiedUserName}}{{Node.Form.LastModifiedTime | date:\'yyyy年MM月dd日hh:mm\'}}</div></div><p></p><button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcRedoForm(Node.Form.Id)">撤销提交</button></section><section ng-switch-default="">PAGE DISPLAY ERROR.</section></div></div><div ng-switch-when="2"><div ng-switch="Node.CheckStatus"><section ng-switch-when="undefined"><h5>未审核 <span class="description">审核状态</span></h5><p>检验报告已提交，等待审核</p><p>检验结论： {{Node.Conclusion}}</p><button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcCheckPass(process.ArrivalSerialNumber,Node.Id)">审核通过</button> <button class="btn btn-block btn-default" ng-click="funcCheckDeny(process.ArrivalSerialNumber,Node.Id)">审核不通过</button></section><section ng-switch-when="0"><h5>未审核 <span class="description">审核状态</span></h5><p>检验报告已提交，等待审核</p><p>检验结论： {{Node.Conclusion}}</p><button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcCheckPass(process.ArrivalSerialNumber,Node.Id)">审核通过</button> <button class="btn btn-block btn-default" ng-click="funcCheckDeny(process.ArrivalSerialNumber,Node.Id)">审核不通过</button></section><section ng-switch-when="1"><h5>审核通过<span class="description">审核状态</span></h5><p>检验报告已完成审核，该检验项完成</p><p>检验结论： {{Node.Conclusion}}</p><div style="line-height: 16px;color: #666;"><div>审核人：{{Node.CheckUserName}} {{Node.CheckTime | date:\'yyyy年MM月dd日 hh:mm\'}}</div></div><p></p><button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcRedoCheck(process.ArrivalSerialNumber,Node.Id)">撤销审核</button></section><section ng-switch-when="2"><h5>审核不通过<span class="description">审核状态</span></h5><p>检验报告已完成审核，该检验项完成</p><p>检验结论： {{Node.Conclusion}}</p><button class="btn btn-block btn-default">查看</button> <button class="btn btn-block btn-default" ng-click="funcRedoCheck(process.ArrivalSerialNumber,Node.Id)">撤销审核</button></section><section ng-switch-default=""><h5>未审核 <span class="description">审核状态</span></h5><p>检验报告已提交，等待审核</p><p>检验结论： {{Node.Conclusion}}</p><button class="btn btn-block btn-default" ng-click="funcViewForm(process.ArrivalSerialNumber,Node.Form.Id)">查看</button> <button class="btn btn-block btn-default" ng-click="funcCheckPass(process.ArrivalSerialNumber,Node.Id)">审核通过</button> <button class="btn btn-block btn-default" ng-click="funcCheckDeny(process.ArrivalSerialNumber,Node.Id)">审核不通过</button></section></div></div><div ng-switch-when="3"><p>检验结论： {{Node.Conclusion}}</p><p class="message">该项检验已经完成<br>点击上方选项来查看详情<br><br>有问题？<a ng-click="funcRedoFormAndCheck(process.ArrivalSerialNumber,Node.Id,Node.Form.Id)">重做该检验项</a></p></div></div></div></li></ul></section></cm-side-menu-content></cm-side-menu-box>'),e.put("app/interaction/process/detail/reference.html",'<div ng-show="uiIsReferenceShow"><div style="display:flex;flex-flow: row wrap;align-items: stretch; justify-content: space-between;"><h4>{{currentReference.Name}}</h4><div style="opacity: 0.6;cursor: pointer;" ng-click="funcHideReference()">关闭</div></div><br><div ng-repeat="Component in currentReference.Components" ng-switch="Component.Type">{{($index+1)+\'. \'}}{{Component.Name}}<div ng-switch-when="table"><table class="table"><thead><tr><th ng-repeat="(Id,Name) in Component.Relation">{{Name}}</th></tr></thead><tbody><tr ng-repeat="row in Component.Data"><td ng-repeat="(Id,Value) in row">{{Value}}</td></tr></tbody></table></div><div ng-switch-when="map"><table class="table"><thead><tr><th ng-repeat="(Id,Value) in Component.Relation">{{Value}}</th></tr></thead><tbody><tr><td ng-repeat="(Id,Value) in Component.Data">{{Value}}</td></tr></tbody></table></div><div ng-switch-when="html" ng-bind-html="Component.Data"></div></div></div><div ng-hide="1||uiIsReferenceShow">请选择要查看的参考数据</div>'),e.put("app/interaction/process/list/base.html",'<cm-side-menu-box><cm-side-menu ng-switch="stateParams.Class"><div ng-switch-when="收货"><section class="category"><ul><li ng-click="funcCreateForm()" style="border-bottom: 1px solid #dddddd;"><span class="ion-plus-round" style="margin-right: 12px"></span>添加收货报告</li></ul></section><section class="category"><h4>收货报告类型</h4><ul><li ng-show="!sideMenuList.length&&!uiIsSideMenuListLoaded">加载中...</li><li ng-show="!sideMenuList.length&&uiIsSideMenuListLoaded">暂无数据</li><li ng-show="sideMenuList.length" ui-sref-active="active" ui-sref="home.process.formList({Class:\'收货\',ProcessTypeId:\'ARRIVAL\',Rev:\'0\',ProcessNodeTypeId:\'AR01\'})" ui-sref-opts="{inherit:false}" title="{{\'收货报告A\'+\'&nbsp;Rev.0\'}}">{{\'收货报告A\'}} <span style="margin-left: 8px;opacity: 0.4; font-size: 10px;">{{\'Rev.0\'}}</span></li></ul></section></div><section class="category" ng-switch-default=""><h4>材料类型分类</h4><ul><li ng-show="!sideMenuList.length&&!uiIsSideMenuListLoaded">加载中...</li><li ng-show="!sideMenuList.length&&uiIsSideMenuListLoaded">暂无数据</li><li ng-show="sideMenuList.length" ui-sref-active="active" ng-repeat="item in sideMenuList" ui-sref="home.process.processList({Class:item.Class,ProcessTypeId:item.Id,Rev:item.Rev})" ui-sref-opts="{inherit:false}" title="{{item.Name+\'&nbsp;Rev.\'+item.Rev}}">{{item.Name}} <span style="margin-left: 8px;opacity: 0.4; font-size: 10px;">{{\'Rev.\'+item.Rev}}</span></li></ul></section></cm-side-menu><div ng-switch="stateParams.Class"><div ng-switch-when="收货"><div ng-if="stateParams.ProcessTypeId&&stateParams.Rev&&stateParams.ProcessNodeTypeId"><ng-include src="\'app/interaction/process/list/count_form.html\'" ng-controller="ProcessListCountCtrl"></ng-include></div><div ng-if="!(stateParams.ProcessTypeId&&stateParams.Rev&&stateParams.ProcessNodeTypeId)"><ng-include src="\'app/interaction/process/list/blank.html\'" ng-controller="ProcessListBlankCtrl"></ng-include></div></div><div ng-switch-default=""><div ng-if="stateParams.ProcessTypeId&&stateParams.Rev"><ng-include src="\'app/interaction/process/list/inspection_process.html\'" ng-controller="ProcessListInspectionCtrl"></ng-include></div><div ng-if="!(stateParams.ProcessTypeId&&stateParams.Rev)"><ng-include src="\'app/interaction/process/list/blank.html\'" ng-controller="ProcessListBlankCtrl"></ng-include></div></div></div></cm-side-menu-box>'),e.put("app/interaction/process/list/blank.html",'<cm-side-menu-content><cm-side-menu-content-header><section class="title"><h2>选择检验物料的类型</h2></section><section class="toolbar"></section></cm-side-menu-content-header><section class="rmi-process-list-blank"><section class="notification" style="{{(uiIsProcessTypesShow&&sideMenuList.length)?\'margin-top:20%\':\'margin-top:25%\'}}"><div>请从左边选择检验的物料类型<br>或 <a ng-click="uiIsProcessTypesShow=!uiIsProcessTypesShow">选择一个默认的类型</a></div></section><section class="processTypes" ng-show="uiIsProcessTypesShow&&sideMenuList.length"><div class="processType" ng-repeat="item in sideMenuList track by $index" ng-click="funcSetDefaultProcessType(item.Id,item.Rev)">{{item.Name}}</div></section></section></cm-side-menu-content>'),e.put("app/interaction/process/list/count_form.html",'<cm-side-menu-content><cm-side-menu-content-header><section class="title"><h2>收货报告列表</h2></section><section class="toolbar"><div class="button">我创建的</div><div class="button">未提交</div><div class="button">已提交</div><div class="button">时间范围 2015.1.1 - 2016.1.1</div></section></cm-side-menu-content-header><section><table ng-table="tableParams" class="table table-striped table-hover list"><tbody><tr ng-repeat="item in $data track by $index"><td data-title="\'\'" style="padding-left: 24px;vertical-align: middle"><div class="cm-table-indicator-dot" style="background-color: {{\'#\'+item.Id}}"></div></td><td data-title="\'状态\'"><div title="{{item.Id}}">{{item.Status | FormStatusFilter}}</div></td><td data-title="\'创建\'"><span class="cm-table-user" title="工号：{{item.CreateUserId}}">{{item.CreateUserName}}</span> <span class="cm-table-time">{{item.CreateTime | date: \'MM月dd日 HH:mm\' }}</span></td><td data-title="\'最后修改\'"><span class="cm-table-user" title="工号：{{item.LastModifiedUserId}}">{{item.LastModifiedUserName}}</span> <span class="cm-table-time">{{item.LastModifiedTime | date: \'MM月dd日 HH:mm\' }}</span></td><td data-title="\'生成的检验任务\'" style="padding-left: 24px;vertical-align: middle"><div style="display: flex"><div ng-repeat="asn in item.Parameter.processes" ui-sref="home.process.detailInfo({ArrivalSerialNumber:asn})" style="margin-right: 8px;cursor: pointer;"><div class="cm-table-indicator-dot" style="{{\'background-color:#\'+asn}}"></div></div></div></td><td data-title="\'操作\'" style="text-align: left"><a ng-click="funcGoDetail(item.ArrivalSerialNumber,item.Id,\'view\')">查看</a> &nbsp; <a ng-show="item.Status!==\'4\'" ng-click="funcGoDetail(item.ArrivalSerialNumber,item.Id,\'edit\')">编辑</a></td></tr></tbody></table></section></cm-side-menu-content>'),e.put("app/interaction/process/list/inspection_process.html",'<cm-side-menu-content class="rmiFormListInspection"><cm-side-menu-content-header><section class="title"><h2>{{tableDataOption.IsComplete===\'true\'?\'已完成\':\'未完成\'}}检验任务列表</h2></section><section class="toolbar"><div class="button {{tableDataOption.IsComplete===\'false\'?\'active\':\'\'}}" ng-click="funcChangeOption(\'IsComplete\',\'false\')">进行中的检验</div><div class="button {{tableDataOption.IsComplete===\'waiting\'?\'active\':\'\'}}" ng-click="funcChangeOption(\'IsComplete\',\'waiting\')">待确认完成</div><div class="button {{tableDataOption.IsComplete===\'true\'?\'active\':\'\'}}" ng-click="funcChangeOption(\'IsComplete\',\'true\')">已完成</div></section></cm-side-menu-content-header><section class="rmiProcessListProcessView"><table ng-table="tableParamsInProcessView" class="table list"><thead><tr><th rowspan="2">#</th><th rowspan="2">分类</th><th rowspan="2" ng-hide="tableDataOption.IsComplete===\'true\'">任务开始时间</th><th rowspan="2" ng-show="tableDataOption.IsComplete===\'true\'">任务完成时间</th><th colspan="4">物料信息</th><th rowspan="2">检验过程</th><th rowspan="2">操作</th></tr><tr><th>物料名称</th><th>货号</th><th>颜色</th><th>供应商</th></tr></thead><tbody><tr ng-repeat="Process in $data track by $index" class="cm-table-vertical-align-middle"><td data-title="\'#\'"><div class="cm-table-indicator-dot" style="background-color: {{\'#\'+Process.ArrivalSerialNumber}};"></div></td><td><div title="{{Process.ArrivalSerialNumber}}">{{Process.TypeName}}</div></td><td class="cm-table-time" ng-hide="tableDataOption.IsComplete===\'true\'">{{Process.StartTime | date:\'MM月dd日 HH:mm\'}}</td><td class="cm-table-time" ng-show="tableDataOption.IsComplete===\'true\'">{{Process.CompleteTime | date:\'MM月dd日 HH:mm\'}}</td><td>{{Process.Parameter.wuliaomingcheng}}</td><td>{{Process.Parameter.huohao}}</td><td>{{Process.Parameter.yanse}}</td><td>{{Process.Parameter.gongyingshang}}</td><td class="processNodeList" style="{{($index===0)?\'border-top:0\':\'\'}}"><div ng-repeat="Node in Process.Nodes" ng-if="Node.Available" class="processNode status-{{Node.Form.Status}}" ng-click="funcGoFormEdit(Process,Node,Node.Form)" title="{{Node.Form.Status|FormStatusFilter}}"><div class="status">{{Node.Form.Status|FormStatusFilter}}</div><div class="name">{{Node.Name}}</div></div></td><td><a ng-click="funcGoDetailInfo(Process.ArrivalSerialNumber)">查看</a></td></tr><tr ng-if="!($data.length>0)"><td colspan="9" ng-switch="tableDataOption.IsComplete"><div ng-switch-when="true" style="height: 64px;width: 100%;line-height: 64px;text-align: center;color: #777">暂无已完成的检验任务</div><div ng-switch-when="false" style="height: 64px;width: 100%;line-height: 64px;text-align: center;color: #777">暂无未完成的检验任务</div><div ng-switch-when="waiting" style="height: 64px;width: 100%;line-height: 64px;text-align: center;color: #777">暂无未完成的检验任务</div></td></tr></tbody></table></section></cm-side-menu-content>'),e.put("app/interaction/control/design/edit/configs.html",'<section class="block"><h4>组件基本信息</h4><section class="map"><div class="row"><div class="item"><div class="name">模板类型</div><div class="input"><label title="映射"><input type="radio" ng-model="generalConfig.Type" value="map" disabled="">映射</label> <label title="表格"><input type="radio" ng-model="generalConfig.Type" value="table" disabled="">表格</label></div></div><div class="item" ng-if="uiIsMap"><div class="name">模板样式</div><div class="input"><label title="映射"><input type="radio" ng-model="generalConfig.Style" value="flex">Flex</label> <label title="表格"><input type="radio" ng-model="generalConfig.Style" value="left">Left</label></div></div><div class="item"><div class="name">是否可见</div><div class="input"><label title="是"><input type="radio" ng-model="generalConfig.Show" value="true" disabled="">是</label> <label title="否"><input type="radio" ng-model="generalConfig.Show" value="false" disabled="">否</label></div></div><div class="item"></div></div><div class="row"><div class="item"><div class="name">快捷初始化函数</div><div class="input" style="width: 100%;"><label style="width: 100%;"><input type="text" class="value" ng-model="generalConfig.QuickInitial" style="width: 100%;"></label></div></div></div></section></section><section class="block" ng-show="uiIsAddPanelShow"><h4 ng-show="uiIsTable">添加表格新的项</h4><h4 ng-show="uiIsMap">添加映射新的项</h4><form name="addNewCol" ng-submit="funcAddUpConfigs()"><section class="map"><div class="row"><div class="item" ng-if="uiIsTable"><div class="name">列名</div><div><input type="text" class="value" ng-model="itemConfig.Name" placeholder="表头显示的内容"></div></div><div class="item" ng-if="uiIsMap" ng-show="generalConfig.Style===\'flex\'"><div class="name">名称</div><div><input type="text" class="value" ng-model="itemConfig.Name" placeholder="说明文字"></div></div><div class="item" ng-if="uiIsMap" ng-show="generalConfig.Style===\'left\'"><div class="name">左描述</div><div><input type="text" class="value" ng-model="itemConfig.LeftDescription" placeholder=""></div></div><div class="item" ng-if="uiIsMap" ng-show="generalConfig.Style===\'left\'"><div class="name">右描述</div><div><input type="text" class="value" ng-model="itemConfig.RightDescription" placeholder=""></div></div><div class="item"><div class="name">属性名</div><div><input type="text" class="value" ng-model="itemConfig.AttributeName" placeholder="数据表属性名" required=""></div></div><div class="item" ng-if="uiIsMap"><div class="name">行号</div><div><input type="text" class="value" ng-model="itemConfig.Row" placeholder="所处的行数"></div></div><div class="item" ng-if="uiIsTable"><div class="name">组名</div><div><input type="text" class="value" ng-model="itemConfig.Group" placeholder="表头分组依据"></div></div><div class="item"><div class="name">宽度</div><div><input type="text" class="value" ng-model="itemConfig.Width" placeholder="填写区域宽度[WIP]"></div></div><div class="item"></div></div><div class="row"><div class="item"><div class="name">域类型</div><div class="input"><label title="文本"><input type="radio" ng-model="itemConfig.Type" value="text">Text</label> <label title="数字"><input type="radio" ng-model="itemConfig.Type" value="number">Number</label> <label title="下拉单选框"><input type="radio" ng-model="itemConfig.Type" value="select">Select</label> <label title="下拉多选框"><input type="radio" ng-model="itemConfig.Type" value="multiSelect">Multi-Select</label> <label title="单选按钮"><input type="radio" ng-model="itemConfig.Type" value="radio">Radio</label> <label title="多选框"><input type="radio" ng-model="itemConfig.Type" value="checkbox">Checkbox</label> <label title="日期选择器"><input type="radio" ng-model="itemConfig.Type" value="date">Date</label> <label title="周选择器"><input type="radio" ng-model="itemConfig.Type" value="week">Week</label> <label title="日期与时间选择器"><input type="radio" ng-model="itemConfig.Type" value="datetime">Datetime</label></div></div></div><div class="row left" ng-show="itemConfig.Type===\'text\'||itemConfig.Type===\'number\'"><div class="item"><div class="left-description">正则表达式</div><div class="input"><label><input type="text" class="value" ng-model="itemConfig.ngPattern"></label></div></div><div class="item"><div class="left-description">最小长度</div><div><input type="number" class="value" style="min-width: 50px;width: 50px;" ng-model="itemConfig.ngMinlength"></div></div><div class="item"><div class="left-description">最大长度</div><div class="input"><label><input type="number" class="value" style="min-width: 50px;width: 50px;" ng-model="itemConfig.ngMaxlength"></label></div></div><div class="item"><div class="input"><label><input type="checkbox" ng-model="itemConfig.ngRequired">必填</label> <label><input type="checkbox" ng-model="itemConfig.ngDisabled">不可修改</label> <label ng-show="itemConfig.Type===\'text\'"><input type="checkbox" ng-model="itemConfig.ngTrim">字符串优化(trim)</label></div></div></div><div class="row left" ng-show="itemConfig.Type===\'number\'"><div class="item"><div class="left-description">范围限定：</div><div class="left-description">最小值</div><div class="input"><label><input type="number" class="value" style="width: 100px;" ng-model="itemConfig.ngMin"></label></div></div><div class="item"><div class="left-description">最大值</div><div class="input"><label><input type="number" class="value" style="width: 100px;" ng-model="itemConfig.ngMax"></label></div></div></div><div class="row" ng-show="itemConfig.Type===\'select\'||itemConfig.Type===\'multiSelect\'||itemConfig.Type===\'checkbox\'||itemConfig.Type===\'radio\'"><div class="item"><div class="left-description">可选值来源</div><div style="cursor: pointer;white-space: nowrap" onclick="alert(\'DEV\')">设置&nbsp;&nbsp;</div><div class="input" style="width:100%;"><label style="width: 100%;"><input type="text" class="value" ng-model="itemConfig.Sources" ng-list="" placeholder="使用预设的可选值列表" style="width: 100%"></label></div></div><div class="item"><div class="input"><label><input type="checkbox" ng-model="itemConfig.ngRequired">必填</label> <label><input type="checkbox" ng-model="itemConfig.ngDisabled">不可修改</label></div></div></div><div class="row" ng-show="itemConfig.Type===\'select\'||itemConfig.Type===\'multiSelect\'||itemConfig.Type===\'checkbox\'||itemConfig.Type===\'radio\'"><div class="item"><div class="name">可选值</div><div class="input" style="width:100%;"><label style="width: 100%;"><input type="text" class="value" ng-model="itemConfig.Options" ng-list="" placeholder="请使用&quot;,&quot;字符来分隔可选项" style="width: 100%"></label></div></div></div><div class="row left" ng-show="itemConfig.Type===\'date\'||itemConfig.Type===\'week\'||itemConfig.Type===\'datetime\'"><div class="item"><div class="left-description">最早时间</div><div class="input"><label><input type="number" class="value" ng-model="itemConfig.ngMin"></label></div></div><div class="item"><div class="left-description">最晚时间</div><div class="input"><label><input type="number" class="value" ng-model="itemConfig.ngMax"></label></div></div><div class="item"><div class="input"><label><input type="checkbox" ng-model="itemConfig.ngRequired">必填</label> <label><input type="checkbox" ng-model="itemConfig.ngDisabled">不可修改</label></div></div></div></section><input class="btn btn-default" type="submit" id="submit" value="添加"></form></section><section class="block"><h4>表格配置信息</h4><table class="table table-hover table-bordered table-condensed"><thead><tr ng-if="uiIsTable"><th width="5%">修改</th><th width="5%" style="cursor:pointer;" ng-click="funcReorderConfigs()">序号</th><th width="15%">组名</th><th width="15%">列名</th><th width="15%">属性名</th><th width="10%">类型</th><th width="35%">限定配置</th></tr><tr ng-if="uiIsMap"><th width="5%">修改</th><th width="5%" style="cursor:pointer;" ng-click="funcReorderConfigs()">序号</th><th width="5%">行号</th><th width="15%">列名</th><th width="15%">属性名</th><th width="10%">类型</th><th width="40%">限定配置</th><th style="width:5%">修改</th></tr></thead><tbody><tr ng-repeat="itemConfig in itemConfigs | orderBy:Order" ng-if="uiIsTable"><td ng-click="funcDeleteFromConfigs($index)" style="cursor: pointer;">删除</td><td><div contenteditable="true" cmcontenteditable="" ng-model="itemConfig.Order"></div></td><td>{{itemConfig.Group}}</td><td>{{itemConfig.Name}}</td><td>{{itemConfig.AttributeName}}</td><td>{{itemConfig.Type}}</td><td style="word-break: break-all;overflow: hidden"><code>{{itemConfig}}</code></td></tr><tr ng-repeat="itemConfig in itemConfigs | orderBy:Order" ng-if="uiIsMap"><td ng-click="funcDeleteFromConfigs($index)" style="cursor: pointer;">删除</td><td><div contenteditable="true" cmcontenteditable="" ng-model="itemConfig.Order"></div></td><td>{{itemConfig.Row}}</td><td>{{itemConfig.Name}}</td><td>{{itemConfig.AttributeName}}</td><td>{{itemConfig.Type}}</td><td style="word-break: break-all;overflow: hidden"><code>{{itemConfig}}</code></td><td ng-click="funcLoadItemConfigToAddPanel(itemConfig,$index)" style="cursor: pointer;">修改</td></tr><tr ng-show="!(itemConfigs.length>0)"><td colspan="8" style="height: 64px;text-align:center;line-height:64px;background-color: #F4F4F4;font-size: 15px">列表为空，请从上面添加项目</td></tr></tbody></table></section><section class="block"><h4>配置信息</h4><pre>\n    {{itemConfigs | json}}\n  </pre></section>'),
e.put("app/interaction/control/design/edit/form.html",'<cm-side-menu-content class="form-table control"><cm-side-menu-content-header><section class="title"><div class="block" ng-if="uiIsEditCache">正在编辑缓存 <span ng-click="funcSaveConfigsCacheAndBack()" class="cm-button">保存并返回</span></div></section><section class="toolbar"></section></cm-side-menu-content-header><section style="display: flex;"><div style="flex: 7;"><section class="block"><h4>表单基本信息</h4><section class="map"><div class="row"><div class="item"><div class="name">可选表单标签</div><input type="text" class="value" ng-model="generalConfig.OptionalTags" ng-list="" placeholder="使用英文逗号分隔" style="width: 67%"></div></div></section></section><section class="block"><h4>添加表单组件</h4><section class="map"><div class="row"><div class="item"><div class="name">通过JSON加载</div><div style="cursor: pointer" ng-click="funcLoadConfig(configString)" class="cm-button">加载</div><input type="text" class="value" ng-model="configString" placeholder="" style="width: 67%"></div></div><div class="row"><div class="item"><div class="name">通过本地缓存加载</div><div>加载&nbsp;&nbsp;&nbsp;&nbsp;</div><div ng-click="funcGoCreateItemConfig(\'table\')" class="cm-button">创建表格组件</div><div ng-click="funcGoCreateItemConfig(\'map\')" class="cm-button">创建映射组件</div><div ng-click="funcGoEditItemConfig(itemConfig.Type)" class="cm-button">编辑当前组件</div></div></div></section><form ng-submit="funcAddUpConfigs()"><section class="map"><div class="row"><div class="item"><div class="name">模板类型</div><div class="input"><label title="映射"><input type="radio" ng-model="itemConfig.Type" value="map">映射</label> <label title="表格"><input type="radio" ng-model="itemConfig.Type" value="table">表格</label></div></div><div class="item" ng-show="itemConfig.Type===\'map\'"><div class="name">模板样式</div><div class="input"><label title="映射"><input type="radio" ng-model="itemConfig.Style" value="flex">Flex</label> <label title="表格"><input type="radio" ng-model="itemConfig.Style" value="left">Left</label></div></div><div class="item"><div class="name">是否可见</div><div class="input"><label title="是"><input type="radio" ng-model="itemConfig.Show" id="inlineRadio3" value="true">是</label> <label title="否"><input type="radio" ng-model="itemConfig.Show" id="inlineRadio4" value="false">否</label></div></div></div><div class="row"><div class="item"><div class="name">快捷初始化函数</div><input type="text" class="value" ng-model="itemConfig.QuickInitial" style="width: 67%;"></div></div><div class="row"><div class="item"><div class="name">模板配置</div><div style="width: 85%;"><pre>{{itemConfig.Config}}</pre></div></div></div></section><input class="btn btn-default" type="submit" id="submit" value="添加"></form></section><section class="block"><h4>表单内容配置信息</h4><table class="table table-hover table-bordered table-condensed"><thead><tr><th style="width:5%">修改</th><th style="width:5%;cursor:pointer;" ng-click="funcReorderConfigs()">序号</th><th style="width:10%">模板类型</th><th style="width:5%">是否显示</th><th style="width:70%;">配置信息</th><th style="width:5%">修改</th></tr></thead><tbody><tr ng-repeat="itemConfig in itemConfigs | orderBy:Order"><td ng-click="funcDeleteFromConfigs($index)" style="cursor: pointer;">删除</td><td><div contenteditable="true" cmcontenteditable="" ng-model="itemConfig.Order"></div></td><td>{{itemConfig.Type}}</td><td>{{itemConfig.Show}}</td><td><code style="word-break: break-all;overflow: hidden">{{itemConfig.Config}}</code></td><td ng-click="funcLoadItemConfigToAddPanel(itemConfig,$index)" style="cursor: pointer;">修改</td></tr><tr ng-show="!(itemConfigs.length>0)"><td colspan="8" style="height: 64px;text-align:center;line-height:64px;background-color: #F4F4F4;font-size: 15px">列表为空，请从上面添加项目</td></tr></tbody></table></section><section class="block"><pre>\n    {{itemConfigs | json}}\n  </pre></section></div><div style="flex: 3;margin-left: 12px;" ng-if="false"><section class="block"><h4>本地组件列表</h4><ul><li ng-repeat="localConfig in localConfigs">{{localConfig.description}} <span style="float: right;">X</span></li></ul></section></div></section></cm-side-menu-content>'),e.put("app/interaction/control/design/edit/map.html",'<cm-side-menu-content class="form-table control"><cm-side-menu-content-header><section class="title"><div class="block" ng-if="uiIsEditCache">正在编辑缓存 <span ng-click="funcSaveConfigsCacheAndBack()" class="cm-button">保存并返回</span></div></section><section class="toolbar"><div class="button {{$parent.uiIsAddPanelShow?\'active\':\'\'}}" ng-click="$parent.uiIsAddPanelShow=!$parent.uiIsAddPanelShow">添加新列</div></section></cm-side-menu-content-header><section style="display: flex;"><div style="flex: 7;"><ng-include src="\'app/control/design/edit/configs.html\'"></ng-include></div><div style="flex: 3;margin-left: 12px" ng-if="false"><section class="block"><h4>缓存的映射配置</h4><ul><li ng-repeat="i in [1,2,3,4,5,6,7,8,9]">{{"Condition:"+i}}</li></ul></section></div></section></cm-side-menu-content>'),e.put("app/interaction/control/design/edit/process.html",'<cm-side-menu-content class="form-table control"><cm-side-menu-content-header><section class="title"><div class="block" ng-if="uiIsEditCache">正在编辑缓存 <span ng-click="funcSaveConfigsCacheAndBack()" class="cm-button">提交流程修改</span></div></section><section class="toolbar"><div class="button" ng-click="funcAddProcessTypeIdToConfigs()">添加ProcessTypeId</div><div class="button" ng-click="funcAddDatabaseTableNameToFormConfigs()">添加生成的数据表名称</div><div class="button" ng-click="funcCreateProcessTypeAndProcessNodeTypes(processConfig,configs)">提交流程</div></section></cm-side-menu-content-header><section class="block"><h4>流程基本信息</h4><section class="map"><div class="row"><div class="item"><div class="name">唯一标识</div><div class="input"><input type="text" class="value" ng-model="generalConfig.Id" placeholder="例如：A01" required=""></div></div><div class="item"><div class="name">修订号</div><div class="input"><input type="text" class="value" ng-model="generalConfig.Rev" placeholder="例如：勾袢" required=""></div></div><div class="item"><div class="name">分类</div><div class="input"><label title="收货"><input type="radio" ng-model="generalConfig.Class" value="收货">收货</label> <label title="主料"><input type="radio" ng-model="generalConfig.Class" value="主料">主料</label> <label title="辅料"><input type="radio" ng-model="generalConfig.Class" value="辅料">辅料</label></div></div></div><div class="row"><div class="item"><div class="name">名称</div><div class="input"><label><input type="text" class="value" ng-model="generalConfig.Name" placeholder="例如：勾袢" required=""></label></div></div></div><div class="row"><div class="item"><div class="name">描述</div><input type="text" class="value" ng-model="generalConfig.Description" style="width: 100%;" placeholder="编辑时的参考文字"></div></div><div class="row"><div class="item"><div class="name">流程完成条件</div><input type="text" class="value" ng-model="generalConfig.CompleteCondition" style="width: 100%;" placeholder="例：PN01.Status=4&PN01.Tag!=>\'严重质量问题\'"></div></div><div class="row"><div class="item"><div class="name">流程参考配置</div><input type="text" class="value" ng-model="generalConfig.Reference" style="width: 100%;" placeholder="配置收货报告、参考文档、标准值参考、选项框内容等"></div></div></section></section><section class="block"><h4>添加流程节点</h4><form ng-submit="funcAddUpConfigs()"><section class="map"><div class="row"><div class="item"><div class="name">节点标识</div><div><input type="text" class="value" ng-model="itemConfig.Id" placeholder="例如：PN01" required=""></div></div><div class="item"><div class="name">名称</div><div><input type="text" class="value" ng-model="itemConfig.Name" placeholder="例如：颜色检验" required=""></div></div><div class="item"></div></div><div class="row"><div class="item"><div class="name">描述</div><input type="text" class="value" ng-model="itemConfig.Description" placeholder="描述信息，可为空" style="width: 60%"></div></div><div class="row"><div class="item"><div class="name">可用性条件</div><input type="text" class="value" ng-model="itemConfig.AvailableCondition" placeholder="表示该节点可用需具备的条件，开发中" style="width: 60%"></div></div><div class="row"><div class="item"><div class="name">导入JSON表单配置</div><div class="cm-button" ng-click="funcLoadConfig(funcPackFormConfigString(configString))">加载</div><input type="text" class="value" ng-model="configString" placeholder="" style="width: 60%"></div></div><div class="row"><div class="item"><div class="name">导入本地表单配置</div><div style="padding-right: 12px">加载</div><div ng-click="funcGoCreateItemConfig(\'form\')" class="cm-button">创建表单</div><div ng-click="funcGoEditItemConfig(\'form\')" class="cm-button">编辑当前表单</div></div></div><div class="row"><div class="item"><div class="name">表单配置</div><div style="width: 85%"><pre>{{itemConfig.FormConfig}}</pre></div></div></div></section><input class="btn btn-default" type="submit" id="submit" value="添加"></form></section><section class="block"><h4>流程节点配置信息</h4><table class="table table-hover table-bordered table-condensed"><thead><tr><th style="width:5%">修改</th><th style="width:5%;cursor:pointer;" ng-click="funcReorderConfigs()">序号</th><th style="width:5%">节点标识</th><th style="width:5%">名称</th><th style="width:15%;">描述</th><th style="width:20%">可用性条件</th><th style="width:40%">表单配置</th><th style="width:5%">修改</th></tr></thead><tbody><tr ng-repeat="itemConfig in itemConfigs | orderBy:Order"><td ng-click="funcDeleteFromConfigs($index)" style="cursor: pointer;">删除</td><td><div contenteditable="true" cmcontenteditable="" ng-model="itemConfig.Order"></div></td><td>{{itemConfig.Id}}</td><td>{{itemConfig.Name}}</td><td><code style="word-break: break-all;overflow: hidden">{{itemConfig.Description}}</code></td><td><code style="word-break: break-all;overflow: hidden">{{itemConfig.AvailableCondition}}</code></td><td><code style="word-break: break-all;overflow: hidden">{{itemConfig.FormConfig}}</code></td><td ng-click="funcLoadItemConfigToAddPanel(itemConfig,$index)" style="cursor: pointer;">修改</td></tr><tr ng-show="!(itemConfigs.length>0)"><td colspan="8" style="height: 64px;text-align:center;line-height:64px;background-color: #F4F4F4;font-size: 15px">列表为空，请从上面添加项目</td></tr></tbody></table></section><section class="block"><pre>\n  {{itemConfigs | json}}\n  </pre></section></cm-side-menu-content>'),e.put("app/interaction/control/design/edit/table.html",'<cm-side-menu-content class="form-table control"><cm-side-menu-content-header><section class="title"><div class="block" ng-if="uiIsEditCache">正在编辑缓存 <span ng-click="funcSaveConfigsCacheAndBack()" class="cm-button">保存并返回</span></div></section><section class="toolbar"><div class="button {{$parent.uiIsAddPanelShow?\'active\':\'\'}}" ng-click="$parent.uiIsAddPanelShow=!$parent.uiIsAddPanelShow">添加新列</div></section></cm-side-menu-content-header><section style="display: flex;"><div style="flex: 7;"><ng-include src="\'app/control/design/edit/configs.html\'"></ng-include></div><div style="flex: 3;margin-left: 12px" ng-if="false"><section class="block"><h4>缓存的表格配置</h4><ul><li ng-repeat="i in [1,2,3,4,5,6,7,8,9]">{{"Condition:"+i}}</li></ul></section></div></section></cm-side-menu-content>')}]);
//# sourceMappingURL=../maps/scripts/app-b298fc5ba5.js.map
